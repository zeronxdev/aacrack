import{_ as e}from"./useTableData.js?v=1720690738171";import{u as t,J as a,ds as s,H as i,j as o,dt as l,k as n,du as r}from"./index.js?v=1720690738171";import{b as d}from"./file2.js?v=1720690738171";import{u as m}from"./useLoading.js?v=1720690738171";import{a as p,_ as c}from"./index.vue_vue_type_script_setup_true_lang12.js?v=1720690738171";import{l as u,r as b,P as y,q as g,S as h,Z as f,V as v,W as x,_ as j,af as w}from"./vue.js?v=1720690738171";import{_}from"./Alert.js?v=1720690738171";import"./Skeleton.js?v=1720690738171";import"./DataTable.js?v=1720690738171";import"./Checkbox.js?v=1720690738171";import"./Ellipsis.js?v=1720690738171";import"./Select.js?v=1720690738171";import"./Tag.js?v=1720690738171";import"./Empty.js?v=1720690738171";import"./omit.js?v=1720690738171";import"./pinia.js?v=1720690738171";import"./Progress.js?v=1720690738171";const D={class:"px-20px py-24px"},k=j("span",{class:"font-bold"},"Warning: ",-1),T=j("span",null," After deleting the database, all data in the database will be cleared and cannot be recovered. ",-1),L={class:"mt-16px text-error"},C=j("p",null,"Please read the above information carefully to prevent accidental deletion.",-1),P={key:0,class:"mt-4px"},S=u({__name:"index",props:{data:{}},emits:["close"],setup(u,{expose:S,emit:R}){const A=u,{ids:B}=A.data,E=R,W=t(),q=b(!0),z=b([]),F=e=>{let t="--";for(let a=0;a<W.remoteList.length;a++){const s=W.remoteList[a];if(s.id===e){t=s.ps||s.db_host;break}}return t},G=b([{key:"name",title:"Database name",ellipsis:{tooltip:{width:"trigger"}}},{key:"total",title:"Size",width:120,render:e=>a(e.total)},{key:"position",title:"Location"},{key:"addtime",title:"Creation time",width:160,render:e=>e.addtime},{key:"result",title:"Delete results",align:"right",width:140,render:e=>e.position!==W.remoteList[0].ps?y("div",{class:"text-error"},[g("Delete Permanently")]):y("div",{class:q.value?"":"text-error"},[q.value?"Move to recycle bin":"Delete Permanently"])}]),{loading:H,setLoading:J}=m(),M=async e=>await r(W.type,{name:e.name,id:e.id}),V=()=>{i({title:"Delete database",hideClose:!0,data:{title:"Delete database",api:M,data:z.value,callback:Z},component:p})},Z=e=>{E("close"),W.setRefresh(!0),i({title:"Batch delete database results",width:440,footer:!0,component:c,data:{title:"Delete database",data:e,status:"done",columns:[{key:"name",title:"Database name",ellipsis:{tooltip:{width:"trigger"}}}]}})};return(async()=>{await(async()=>{const{message:e}=await d();o(e)&&(q.value=e.status_db)})(),(async()=>{try{J(!0);const{message:e}=await l({ids:B});o(e)?z.value=n(e.data)?e.data.map((e=>({...e,position:F(e.sid)}))):[]:z.value=[]}finally{J(!1)}})()})(),S({onConfirm:()=>{s({text:"Delete database",title:"Two-step verification - delete database",content:q.value?"The deleted database will be moved to the Recycle Bin. Do you want to continue?":"The data will be completely deleted and cannot be recovered. Do you want to continue?",onConfirm:async({hide:e})=>{V(),e()}})}}),(t,a)=>{const s=_,i=e;return h(),f("div",D,[y(s,{type:"warning"},{default:v((()=>[k,T])),_:1}),y(i,{class:"mt-16px",loading:x(H),"loading-num":x(B).length,"max-height":300,data:x(z),columns:x(G)},null,8,["loading","loading-num","data","columns"]),j("div",L,[C,x(q)?w("",!0):(h(),f("p",P," The database recycle bin is not enabled, please operate with caution! Go to enable --\x3e File management --\x3e Recycle bin "))])])}}});export{S as default};
