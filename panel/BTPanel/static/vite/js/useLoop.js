import{cr as t,aR as e,bn as r,aF as s,aV as o,cc as a,bP as i,bI as n,bJ as l,bS as c}from"./index.js?v=1720690738171";import{M as p,k as u,r as d,y as f,l as v,a as h,p as m,v as S,x as y,A as g,d as b,L as w,N as x}from"./vue.js?v=1720690738171";function R(t,e){var r;if(null==t)return;const s=function(t){if("number"==typeof t)return{"":t.toString()};const e={};return t.split(/ +/).forEach((t=>{if(""===t)return;const[r,s]=t.split(":");void 0===s?e[""]=r:e[r]=s})),e}(t);if(void 0===e)return s[""];if("string"==typeof e)return null!==(r=s[e])&&void 0!==r?r:s[""];if(Array.isArray(e)){for(let t=e.length-1;t>=0;--t){const r=e[t];if(r in s)return s[r]}return s[""]}{let t,r=-1;return Object.keys(s).forEach((o=>{const a=Number(o);!Number.isNaN(a)&&e>=a&&a>=r&&(r=a,t=s[o])})),t}}const G={xs:0,s:640,m:1024,l:1280,xl:1536,"2xl":1920};const N={};const C=e("n-grid"),E=1,_=v({__GRID_ITEM__:!0,name:"GridItem",alias:["Gi"],props:{span:{type:[Number,String],default:E},offset:{type:[Number,String],default:0},suffix:Boolean,privateOffset:Number,privateSpan:Number,privateColStart:Number,privateShow:{type:Boolean,default:!0}},setup(){const{isSsrRef:t,xGapRef:e,itemStyleRef:s,overflowRef:o,layoutShiftDisabledRef:a}=h(C),i=S();return{overflow:o,itemStyle:s,layoutShiftDisabled:a,mergedXGap:u((()=>r(e.value||0))),deriveStyle:()=>{t.value;const{privateSpan:s=E,privateShow:o=!0,privateColStart:a,privateOffset:n=0}=i.vnode.props,{value:l}=e,c=r(l||0);return{display:o?"":"none",gridColumn:"".concat(null!=a?a:"span ".concat(s)," / span ").concat(s),marginLeft:n?"calc((100% - (".concat(s," - 1) * ").concat(c,") / ").concat(s," * ").concat(n," + ").concat(c," * ").concat(n,")"):""}}}},render(){var t,e;if(this.layoutShiftDisabled){const{span:t,offset:e,mergedXGap:r}=this;return m("div",{style:{gridColumn:"span ".concat(t," / span ").concat(t),marginLeft:e?"calc((100% - (".concat(t," - 1) * ").concat(r,") / ").concat(t," * ").concat(e," + ").concat(r," * ").concat(e,")"):""}},this.$slots)}return m("div",{style:[this.itemStyle,this.deriveStyle()]},null===(e=(t=this.$slots).default)||void 0===e?void 0:e.call(t,{overflow:this.overflow}))}}),D={xs:0,s:640,m:1024,l:1280,xl:1536,xxl:1920},I="__ssr__",B=v({name:"Grid",inheritAttrs:!1,props:{layoutShiftDisabled:Boolean,responsive:{type:[String,Boolean],default:"self"},cols:{type:[Number,String],default:24},itemResponsive:Boolean,collapsed:Boolean,collapsedRows:{type:Number,default:1},itemStyle:[Object,String],xGap:{type:[Number,String],default:0},yGap:{type:[Number,String],default:0}},setup(e){const{mergedClsPrefixRef:i,mergedBreakpointsRef:n}=s(e),l=/^\d+$/,p=d(void 0),v=function(e=G){if(!t)return u((()=>[]));if("function"!=typeof window.matchMedia)return u((()=>[]));const r=d({}),s=Object.keys(e),o=(t,e)=>{t.matches?r.value[e]=!0:r.value[e]=!1};return s.forEach((t=>{const r=e[t];let s,a;void 0===N[r]?(s=window.matchMedia("(min-width: ".concat(r,"px)")),s.addEventListener?s.addEventListener("change",(e=>{a.forEach((r=>{r(e,t)}))})):s.addListener&&s.addListener((e=>{a.forEach((r=>{r(e,t)}))})),a=new Set,N[r]={mql:s,cbs:a}):(s=N[r].mql,a=N[r].cbs),a.add(o),s.matches&&a.forEach((e=>{e(s,t)}))})),f((()=>{s.forEach((t=>{const{cbs:r}=N[e[t]];r.has(o)&&r.delete(o)}))})),u((()=>{const{value:t}=r;return s.filter((e=>t[e]))}))}((null==n?void 0:n.value)||D),h=o((()=>!!e.itemResponsive||(!l.test(e.cols.toString())||(!l.test(e.xGap.toString())||!l.test(e.yGap.toString()))))),m=u((()=>{if(h.value)return"self"===e.responsive?p.value:v.value})),S=o((()=>{var t;return null!==(t=Number(R(e.cols.toString(),m.value)))&&void 0!==t?t:24})),w=o((()=>R(e.xGap.toString(),m.value))),x=o((()=>R(e.yGap.toString(),m.value))),E=t=>{p.value=t.contentRect.width},_=t=>{c(E,t)},B=d(!1),L=u((()=>{if("self"===e.responsive)return _})),O=d(!1),T=d();return y((()=>{const{value:t}=T;t&&t.hasAttribute(I)&&(t.removeAttribute(I),O.value=!0)})),g(C,{layoutShiftDisabledRef:b(e,"layoutShiftDisabled"),isSsrRef:O,itemStyleRef:b(e,"itemStyle"),xGapRef:w,overflowRef:B}),{isSsr:!a,contentEl:T,mergedClsPrefix:i,style:u((()=>e.layoutShiftDisabled?{width:"100%",display:"grid",gridTemplateColumns:"repeat(".concat(e.cols,", minmax(0, 1fr))"),columnGap:r(e.xGap),rowGap:r(e.yGap)}:{width:"100%",display:"grid",gridTemplateColumns:"repeat(".concat(S.value,", minmax(0, 1fr))"),columnGap:r(w.value),rowGap:r(x.value)})),isResponsive:h,responsiveQuery:m,responsiveCols:S,handleResize:L,overflow:B}},render(){if(this.layoutShiftDisabled)return m("div",w({ref:"contentEl",class:"".concat(this.mergedClsPrefix,"-grid"),style:this.style},this.$attrs),this.$slots);const t=()=>{var t,e,r,s,o,a,i;this.overflow=!1;const c=n(l(this)),u=[],{collapsed:d,collapsedRows:f,responsiveCols:v,responsiveQuery:h}=this;c.forEach((t=>{var e,r,s,o,a;if(!0!==(null===(e=null==t?void 0:t.type)||void 0===e?void 0:e.__GRID_ITEM__))return;if(function(t){var e;const r=null===(e=t.dirs)||void 0===e?void 0:e.find((({dir:t})=>t===p));return!(!r||!1!==r.value)}(t)){const e=x(t);return e.props?e.props.privateShow=!1:e.props={privateShow:!1},void u.push({child:e,rawChildSpan:0})}t.dirs=(null===(r=t.dirs)||void 0===r?void 0:r.filter((({dir:t})=>t!==p)))||null,0===(null===(s=t.dirs)||void 0===s?void 0:s.length)&&(t.dirs=null);const i=x(t),n=Number(null!==(a=R(null===(o=i.props)||void 0===o?void 0:o.span,h))&&void 0!==a?a:1);0!==n&&u.push({child:i,rawChildSpan:n})}));let S=0;const y=null===(t=u[u.length-1])||void 0===t?void 0:t.child;if(null==y?void 0:y.props){const t=null===(e=y.props)||void 0===e?void 0:e.suffix;void 0!==t&&!1!==t&&(S=Number(null!==(s=R(null===(r=y.props)||void 0===r?void 0:r.span,h))&&void 0!==s?s:1),y.props.privateSpan=S,y.props.privateColStart=v+1-S,y.props.privateShow=null===(o=y.props.privateShow)||void 0===o||o)}let g=0,b=!1;for(const{child:n,rawChildSpan:l}of u){if(b&&(this.overflow=!0),!b){const t=Number(null!==(i=R(null===(a=n.props)||void 0===a?void 0:a.offset,h))&&void 0!==i?i:0),e=Math.min(l+t,v);if(n.props?(n.props.privateSpan=e,n.props.privateOffset=t):n.props={privateSpan:e,privateOffset:t},d){const t=g%v;e+t>v&&(g+=v-t),e+g+S>f*v?b=!0:g+=e}}b&&(n.props?!0!==n.props.privateShow&&(n.props.privateShow=!1):n.props={privateShow:!1})}return m("div",w({ref:"contentEl",class:"".concat(this.mergedClsPrefix,"-grid"),style:this.style,[I]:this.isSsr||void 0},this.$attrs),u.map((({child:t})=>t)))};return this.isResponsive&&"self"===this.responsive?m(i,{onResize:this.handleResize},{default:t}):t()}}),L=t=>{let e=t.slice(1),r=1;3===e.length&&(e="".concat(e[0]).concat(e[0]).concat(e[1]).concat(e[1]).concat(e[2]).concat(e[2])),8===e.length&&(r=parseInt(e.slice(6),16)/255,e=e.slice(0,6));const s=parseInt(e,16);return{r:s>>16&255,g:s>>8&255,b:255&s,a:r}},O=t=>{if(t.startsWith("#"))return L(t);if(t.startsWith("rgb"))return(t=>{const e=t.match(/(\d(\.\d+)?)+/g)||[],r=e.map((t=>parseInt(t,10)));return{r:r[0],g:r[1],b:r[2],a:parseFloat(e[3])}})(t);if("transparent"===t)return L("#00000000");throw new Error("color string error: ".concat(t))},T=(t,e=1)=>((t,e=1)=>{const{r:r,g:s,b:o}=t;return"rgba(".concat(r,",").concat(s,",").concat(o,",").concat(e,")")})(O(t),e);function A(t,e=3){let r=null,s=!1,o=0;const a=()=>{s||(o>=3?i():r=window.setTimeout((async()=>{try{await t(),o=0}catch(e){o++}finally{a()}}),1e3*e))},i=()=>{r&&(clearTimeout(r),r=null)};return f((()=>{s=!0,i()})),{loop:a,clearTimer:i}}export{_,B as a,T as h,A as u};
