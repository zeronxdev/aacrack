System.register(["./index-legacy53.js?v=1720690738171","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1720690738171","./useTableData-legacy.js?v=1720690738171","./index-legacy.js?v=1720690738171","./file-legacy2.js?v=1720690738171","./useLoading-legacy.js?v=1720690738171","./useTableColumns-legacy.js?v=1720690738171","./file-legacy.js?v=1720690738171","./vue-legacy.js?v=1720690738171","./Skeleton-legacy.js?v=1720690738171","./DataTable-legacy.js?v=1720690738171","./Checkbox-legacy.js?v=1720690738171","./Ellipsis-legacy.js?v=1720690738171","./Select-legacy.js?v=1720690738171","./Tag-legacy.js?v=1720690738171","./Empty-legacy.js?v=1720690738171","./omit-legacy.js?v=1720690738171","./pinia-legacy.js?v=1720690738171","./Progress-legacy.js?v=1720690738171","./useAccount-legacy.js?v=1720690738171"],(function(e,t){"use strict";var l,a,s,i,n,o,c,r,u,g,d,p,y,m,f,h,j,b,w,z,_,k,v,x,S,q;return{setters:[e=>{l=e._},e=>{a=e._},e=>{s=e.u,i=e._},e=>{n=e.u,o=e.K,c=e.J,r=e.h,u=e.dm,g=e.j,d=e.k,p=e.cd,y=e.B},e=>{m=e.d,f=e.a},e=>{h=e.u},e=>{j=e.b},e=>{b=e.o},e=>{w=e.l,z=e.S,_=e.Z,k=e.P,v=e.V,x=e.q,S=e.W,q=e._},null,null,null,null,null,null,null,null,null,null,null],execute:function(){const t={class:"p-20px"},C=q("li",null,"Only support sql, zip, (tar.gz|gz|tgz)",-1),D=q("li",null," Structure of zip, tar.gz archive: test.sql must be contained in test.zip or test.tar.gz ",-1),E=q("li",null," If the file is oversized, you can also upload database archives to /www/backup/database with SFTP tools ",-1);e("default",w({__name:"index",props:{data:{}},setup(e){const w=e,{row:q}=w.data,T=n(),F=()=>{if(!T.backupPath)throw new Error("No backup directory");return T.backupPath+"/database"},I=()=>{const e=F(),t="pgsql"==T.type?".sql":".sql,.gz,.tar.gz,.zip";b(e,t,(()=>{$()}))},{table:L,columns:P}=s([{key:"filename",title:"File name",ellipsis:{tooltip:{width:"trigger"}}},{key:"addtime",title:"Modification time",width:150,render:e=>o(e.etime)},{key:"size",title:"Size",width:100,render:e=>c(e.size)},j({width:100,options:e=>[{label:"Import",onClick:()=>{r({title:"Import Database",content:"Database will be overwritten, continue?",onConfirm:async({hide:t})=>{await(async e=>{await u(T.type,{file:F()+"/"+e.filename,name:q.name})})(e),t()}})}},{label:"Del",onClick:()=>{r({title:`Delete file [${e.filename}]`,content:`Are you sure to put this file [${e.filename}] to recycle bin?`,onConfirm:async({hide:t})=>{await(async e=>{await m({path:F()+"/"+e.filename}),$(),T.setRefresh(!0)})(e),t()}})}}]})]),{loading:A,setLoading:R}=h(),$=async()=>{try{R(!0);const{message:e}=await f({p:1,reverse:"True",sort:"mtime",tojs:"GetFiles",showRow:100,path:F()});L.data=[],g(e)&&d(e.FILES)&&e.FILES.forEach((e=>{if(!e)return;const t=e.split(";"),l=(e=>{const t=e.split(".");return t[t.length-1]})(t[0]);"sql"!=l&&"zip"!=l&&"gz"!=l&&"tgz"!=l||L.data.push({filename:t[0],size:p(t[1]),etime:p(t[2])})}))}finally{R(!1)}};return $(),(e,s)=>{const n=y,o=i,c=a,r=l;return z(),_("div",t,[k(c,null,{toolsLeft:v((()=>[k(n,{onClick:I},{default:v((()=>[x("Upload from local")])),_:1})])),table:v((()=>[k(o,{"max-height":348,loading:S(A),data:S(L).data,columns:S(P)},null,8,["loading","data","columns"])])),_:1}),k(r,{class:"mt-16px"},{default:v((()=>[C,D,E])),_:1})])}}}))}}}));
