System.register(["./index-legacy.js?v=1720690738171","./index-legacy112.js?v=1720690738171","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1720690738171","./index.vue_vue_type_script_setup_true_lang-legacy2.js?v=1720690738171","./index.vue_vue_type_script_setup_true_lang-legacy3.js?v=1720690738171","./useTableData-legacy.js?v=1720690738171","./useLoading-legacy.js?v=1720690738171","./useTableColumns-legacy.js?v=1720690738171","./site-legacy2.js?v=1720690738171","./vue-legacy.js?v=1720690738171","./pinia-legacy.js?v=1720690738171","./Spin-legacy.js?v=1720690738171","./DataTable-legacy.js?v=1720690738171","./Checkbox-legacy.js?v=1720690738171","./Ellipsis-legacy.js?v=1720690738171","./Select-legacy.js?v=1720690738171","./Tag-legacy.js?v=1720690738171","./Empty-legacy.js?v=1720690738171","./omit-legacy.js?v=1720690738171","./Skeleton-legacy.js?v=1720690738171","./Progress-legacy.js?v=1720690738171"],(function(e,l){"use strict";var a,t,i,n,s,c,o,u,d,p,g,y,r,m,_,k,b,h,w,f,j,v,x,C,T,R,z,S,D,U,B,L,P;return{setters:[e=>{a=e.J,t=e.dn,i=e.h,n=e.j,s=e.k,c=e.m,o=e.B,u=e.q},e=>{d=e._},e=>{p=e._},e=>{g=e.a},e=>{y=e._},e=>{r=e.u,m=e._},e=>{_=e.u},e=>{k=e.b},e=>{b=e.b6,h=e.b7,w=e.b,f=e.b8,j=e.b9},e=>{v=e.l,x=e.r,C=e.f,T=e.t,R=e.S,z=e.Z,S=e.P,D=e.V,U=e.q,B=e.W,L=e.b,P=e._},null,null,null,null,null,null,null,null,null,null,null],execute:function(){const l={class:"p-20px"},q={class:"w-600px h-400px bg-#282c34"};e("default",v({__name:"index",props:{data:{}},setup(e){const v=e,{row:E}=v.data,F=async()=>{await w({id:E.id}),Q(),E.backup_count++},K=x(!1),A=x("");let J=null,V=!1;const W=()=>{A.value="",K.value=!0,Z()},Z=async(e=0)=>{V?J&&clearTimeout(J):J=window.setTimeout((async()=>{try{const{message:e}=await j();n(e)&&(A.value=e.result)}finally{Z(1e3)}}),e)},{keys:$,table:G,columns:H}=r([{type:"selection",width:40},{key:"name",title:"File name",ellipsis:{tooltip:{width:"trigger"}}},{key:"size",title:"File size",width:90,render:e=>a(e.size)},{key:"addtime",title:"Backup time",width:150},k({width:170,options:e=>[{label:"Restore",onClick:()=>{(e=>{i({title:"Restore backup file",content:"Are you sure to restore backup file?",onConfirm:async({hide:l})=>{l(),W(),V=!1,await f({file_name:e.name,site_id:E.id}),V=!0,K.value=!1}})})(e)}},{label:"Download",onClick:()=>{t(e.filename,e.name)}},{label:"Del",onClick:()=>{i({title:"Delete backup file",content:`The website backup is about to be deleted [${e.name}], do you want to continue?`,onConfirm:async({hide:l})=>{await b({id:e.id}),Q(),E.backup_count--,l()}})}}]})]),I=[{key:"del",type:"confirm",label:"Please choose del",confirm:{title:"Batch delete",desc:"Please be cautious, The selected item will be [delete] after confirmation",columns:[H.value[1]],api:e=>b({id:e.id},!1),done:e=>{Q(),E.backup_count-=e.length}}}],M=C({p:1,limit:10,search:E.id}),{loading:N,setLoading:O}=_(),Q=async()=>{try{O(!0);const{message:e}=await h(T(M));n(e)?(G.data=s(e.data)?e.data:[],G.total=c(e.page)):(G.data=[],G.total=0)}finally{$.value=[],O(!1)}};return Q(),(e,a)=>{const t=o,i=m,n=y,s=g,c=p,r=d,_=u;return R(),z("div",l,[S(c,null,{toolsLeft:D((()=>[S(t,{type:"primary",onClick:F},{default:D((()=>[U("Backup")])),_:1})])),table:D((()=>[S(i,{"checked-row-keys":B($),"onUpdate:checkedRowKeys":a[0]||(a[0]=e=>L($)?$.value=e:null),loading:B(N),"loading-num":1,"max-height":340,data:B(G).data,columns:B(H)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:D((()=>[S(n,{"checked-row-keys":B($),"onUpdate:checkedRowKeys":a[1]||(a[1]=e=>L($)?$.value=e:null),data:B(G).data,options:I},null,8,["checked-row-keys","data"])])),pageRight:D((()=>[S(s,{page:B(M).p,"onUpdate:page":a[2]||(a[2]=e=>B(M).p=e),"page-size":B(M).limit,"onUpdate:pageSize":a[3]||(a[3]=e=>B(M).limit=e),"item-count":B(G).total,onRefresh:Q},null,8,["page","page-size","item-count"])])),_:1}),S(_,{show:B(K),"onUpdate:show":a[4]||(a[4]=e=>L(K)?K.value=e:null),title:"Recovering backup","hide-close":!0},{default:D((()=>[P("div",q,[S(r,{log:B(A)},null,8,["log"])])])),_:1},8,["show"])])}}}))}}}));
