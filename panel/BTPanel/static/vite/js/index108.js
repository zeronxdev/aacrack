const __vite__fileDeps=["js/rewrite.js?v=1720690738171","js/index53.js?v=1720690738171","js/index.js?v=1720690738171","js/vue.js?v=1720690738171","js/pinia.js?v=1720690738171","css/index29.css?v=1720690738171","js/file2.js?v=1720690738171","js/index.vue_vue_type_script_setup_true_lang11.js?v=1720690738171","js/useLoading.js?v=1720690738171","js/Select.js?v=1720690738171","js/Tag.js?v=1720690738171","js/Empty.js?v=1720690738171","js/Spin.js?v=1720690738171","js/uniq.js?v=1720690738171","js/_baseUniq.js?v=1720690738171","js/_baseFindIndex.js?v=1720690738171","js/index124.js?v=1720690738171","js/index.vue_vue_type_script_setup_true_lang5.js?v=1720690738171","js/site2.js?v=1720690738171","js/index111.js?v=1720690738171","js/Tabs.js?v=1720690738171","js/omit.js?v=1720690738171","js/Ellipsis.js?v=1720690738171","css/index12.css?v=1720690738171","js/index.vue_vue_type_script_setup_true_lang.js?v=1720690738171","js/useTableColumns.js?v=1720690738171","js/Progress.js?v=1720690738171","css/useTableColumns.css?v=1720690738171","js/index.vue_vue_type_script_setup_true_lang3.js?v=1720690738171","js/Checkbox.js?v=1720690738171","js/useTableData.js?v=1720690738171","js/Skeleton.js?v=1720690738171","js/DataTable.js?v=1720690738171","js/index85.js?v=1720690738171","js/use-theme-vars.js?v=1720690738171","css/index10.css?v=1720690738171","js/index.vue_vue_type_script_setup_true_lang10.js?v=1720690738171","js/index.vue_vue_type_script_setup_true_lang7.js?v=1720690738171","js/InputGroupLabel.js?v=1720690738171","js/InputGroup.js?v=1720690738171","js/index57.js?v=1720690738171","css/index9.css?v=1720690738171","js/index49.js?v=1720690738171","css/index8.css?v=1720690738171","js/form.vue_vue_type_script_setup_true_lang.js?v=1720690738171","js/useAccount.js?v=1720690738171","js/php.js?v=1720690738171","js/Space.js?v=1720690738171","js/index112.js?v=1720690738171","css/index13.css?v=1720690738171","js/old4.js?v=1720690738171","js/site.js?v=1720690738171"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{e,h as a,n as t,k as l,B as s,g as i,v as n,j as o,aj as r,a9 as d,G as u,q as c,p,b8 as m,cC as h,z as v,cv as y,a as f,b1 as w,cJ as _,H as g}from"./index.js?v=1720690738171";import{_ as b}from"./index111.js?v=1720690738171";import{s as x}from"./pinia.js?v=1720690738171";import{A as k,a as P,P as U,q as C,l as L,r as R,S,Z as E,_ as T,V as j,W as D,b as A,f as N,a1 as I,F as q,af as B,t as M,U as H,x as K,al as O,a3 as z,a5 as W,a6 as V,ag as F,k as X,n as $}from"./vue.js?v=1720690738171";import{_ as G}from"./index.vue_vue_type_script_setup_true_lang.js?v=1720690738171";import{_ as Q}from"./index.vue_vue_type_script_setup_true_lang3.js?v=1720690738171";import{u as Y,_ as Z}from"./useTableData.js?v=1720690738171";import{_ as J}from"./index85.js?v=1720690738171";import{X as ee,V as ae,W as te,aQ as le,aR as se,aS as ie,aT as ne,aU as oe,Y as re,Z as de,_ as ue,$ as ce,a0 as pe,a1 as me,a2 as he,a3 as ve,a4 as ye,a5 as fe,a6 as we,a7 as _e,a8 as ge,a9 as be,aa as xe,ab as ke,ac as Pe,ad as Ue,ae as Ce,aV as Le,aW as Re,af as Se,ag as Ee,ah as Te,ai as je,aj as De,al as Ae,am as Ne,an as Ie,aX as qe,aY as Be,aZ as Me,a_ as He,a$ as Ke,b0 as Oe,b1 as ze,ao as We,ap as Ve,aq as Fe,ar as Xe,as as $e,at as Ge,au as Qe,av as Ye,aw as Ze,ax as Je,ay as ea,az as aa,aA as ta,aB as la,aC as sa,aD as ia,aE as na,aF as oa,aG as ra}from"./site2.js?v=1720690738171";import{u as da}from"./useLoading.js?v=1720690738171";import{B as ua,b as ca,_ as pa,i as ma}from"./useTableColumns.js?v=1720690738171";import{_ as ha}from"./Select.js?v=1720690738171";import{_ as va,a as ya}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1720690738171";import{_ as fa}from"./index.vue_vue_type_script_setup_true_lang10.js?v=1720690738171";import{_ as wa}from"./index57.js?v=1720690738171";import{_ as _a}from"./index53.js?v=1720690738171";import{_ as ga,a as ba}from"./Checkbox.js?v=1720690738171";import{_ as xa}from"./index.vue_vue_type_script_setup_true_lang11.js?v=1720690738171";import{_ as ka}from"./index49.js?v=1720690738171";import{_ as Pa,a as Ua,b as Ca,c as La}from"./form.vue_vue_type_script_setup_true_lang.js?v=1720690738171";import{b as Ra}from"./useAccount.js?v=1720690738171";import{a as Sa,b as Ea}from"./php.js?v=1720690738171";import{_ as Ta}from"./Space.js?v=1720690738171";import{_ as ja}from"./InputGroupLabel.js?v=1720690738171";import{_ as Da}from"./InputGroup.js?v=1720690738171";import{_ as Aa}from"./index112.js?v=1720690738171";import{_ as Na}from"./Spin.js?v=1720690738171";import{_ as Ia}from"./Progress.js?v=1720690738171";const qa=Symbol("server-list");function Ba(){return P(qa)}function Ma({delDomain:e}){return{key:"action",title:"OPT",width:80,align:"right",render:t=>U(ua,{options:[{label:"Del",onClick:()=>{a({title:"Delete domain [".concat(t.name,"]"),content:"Are you sure to delete this domain name?",onConfirm:async({hide:a})=>{await e(t),a()}})}}]},null)}}const Ha={class:"flex justify-between items-center mb-24px"},Ka={class:"w-400px"},Oa=T("p",null,"A domain per line, the default port is 80",-1),za=T("p",null,"Wildcard domain format: *.domain.com",-1),Wa=T("p",null,"To add another port, the format is www.domain.com:88",-1),Va={class:"pr-40px"},Fa=L({__name:"index",setup(a,{expose:i}){const{data:n}=Ba(),o=R(""),r=async()=>{""!==o.value.trim()?(await ee({id:n.id,webname:n.name,domain:o.value.trim().split("\n").join(",")}),o.value="",f()):t.error("Domain name cannot be empty")},d=async e=>{await ae({id:n.id,webname:n.name,domain:e.name,port:e.port}),f()},{keys:u,table:c,columns:p}=Y([{type:"selection",width:40},{key:"name",title:"Domain name",render:a=>U(e,{href:"http://".concat(a.name,":").concat(a.port),target:"_blank"},{default:()=>[a.name]})},{key:"port",title:"Port",width:100},Ma({delDomain:d})]),m=()=>{c.data.length>1?p.value[p.value.length-1]=Ma({delDomain:d}):p.value[p.value.length-1]={key:"action",title:"OPT",width:80,align:"right",render:()=>U("span",{class:"text-default"},[C("Inoperable")])}},h=[{key:"del",type:"confirm",label:"Please choose del",confirm:{title:"Batch delete",desc:"Please be cautious, The selected item will be [delete] after confirmation",api:e=>ae({id:n.id,webname:n.name,domain:e.name,port:e.port},!1),done:()=>{f()},columns:[{key:"name",title:"Domain name",ellipsis:{tooltip:{width:"trigger"}}}]}}],{loading:v,setLoading:y}=da(),f=async()=>{try{y(!0);const e={id:n.id},{message:a}=await te(e);c.data=l(a)?a:[],m()}finally{u.value=[],y(!1)}};return f(),i({init:f}),(e,a)=>{const t=J,l=s,i=Z,n=Q,d=G;return S(),E("div",null,[T("div",Ha,[T("div",Ka,[U(t,{value:D(o),"onUpdate:value":a[0]||(a[0]=e=>A(o)?o.value=e:null)},{default:j((()=>[Oa,za,Wa])),_:1},8,["value"])]),T("div",Va,[U(l,{type:"primary",onClick:r},{default:j((()=>[C("Add")])),_:1})])]),U(d,null,{table:j((()=>[U(i,{"checked-row-keys":D(u),"onUpdate:checkedRowKeys":a[1]||(a[1]=e=>A(u)?u.value=e:null),loading:D(v),"max-height":400,data:D(c).data,columns:D(p)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:j((()=>[U(n,{"checked-row-keys":D(u),"onUpdate:checkedRowKeys":a[2]||(a[2]=e=>A(u)?u.value=e:null),data:D(c).data,options:h},null,8,["checked-row-keys","data"])])),_:1})])}}}),Xa=T("div",null,"Domain name",-1),$a={class:"w-140px"},Ga=T("div",null,"Subdir",-1),Qa={class:"w-120px"},Ya=L({__name:"index",setup(e,{expose:p}){const m=I((()=>n((()=>import("./rewrite.js?v=1720690738171")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])))),{data:h}=Ba(),v=N({domain:"",dirName:null}),y=R([]),f=async()=>{const e=v.dirName;""!==v.domain.trim()?null!==e?(await se({id:h.id,domain:v.domain,dirName:e}),q()):t.error("Subdirectory name cannot be empty"):t.error("Domain cannot be empty")},w=i("Configurate rewirte rules",{data:"",filename:"",rlist:[]}),_=e=>{w.data.filename=e.filename,w.data.fileContent=e.data,w.data.rlist=e.rlist,w.show=!0},{keys:g,table:b,columns:x}=Y([{type:"selection",width:40},{key:"domain",title:"Domain name",ellipsis:{tooltip:{width:"trigger"}}},{key:"port",title:"Port",width:80},{key:"path",title:"Subdir",width:120,ellipsis:{tooltip:{width:"trigger"}}},ca({width:130,options:e=>[{label:"URL rewrite",onClick:()=>{(async e=>{try{const{message:a}=await ie({id:e.id});o(a)&&_(a)}catch(l){const s=r(l,"meesage.result","");s?t.error(s):a({title:"Tips",content:"Are you sure to create a independent URL rewrite rule for this subdirectory?",onConfirm:async({hide:a})=>{const{message:t}=await ne({id:e.id});o(t)&&_(t),a()}})}})(e)}},{label:"Del",onClick:()=>{a({title:"Are you sure to delete this [".concat(e.path,"] subdirectory binding?"),content:"Are you sure to delete this subdirectory binding?",onConfirm:async({hide:a})=>{await le({id:e.id}),q(),a()}})}}]})]),k=[{key:"del",type:"confirm",label:"Please choose del",confirm:{title:"Batch delete",desc:"Please be cautious, The selected item will be [delete] after confirmation",api:e=>le({id:e.id},!1),done:()=>{q()},columns:[{key:"domain",title:"Domain name",ellipsis:{tooltip:{width:"trigger"}}}]}}],{loading:P,setLoading:L}=da(),q=()=>{v.domain="",v.dirName=null,(async()=>{try{L(!0);const{message:e}=await oe({id:h.id});if(o(e)){const{dirs:a,binding:t}=e;l(a)&&a.length>0?(y.value=a.map((e=>({label:e,value:e}))),v.dirName=a[0]):(y.value=[],v.dirName=null),b.data=l(t)?t:[]}}finally{g.value=[],L(!1)}})()};return q(),p({init:q}),(e,a)=>{const t=d,l=u,i=ha,n=s,o=Z,r=Q,p=G,h=c;return S(),E("div",null,[U(l,{class:"items-center",size:16},{default:j((()=>[U(l,{class:"items-center"},{default:j((()=>[Xa,T("div",$a,[U(t,{value:D(v).domain,"onUpdate:value":a[0]||(a[0]=e=>D(v).domain=e),placeholder:""},null,8,["value"])])])),_:1}),U(l,{class:"items-center"},{default:j((()=>[Ga,T("div",Qa,[U(i,{value:D(v).dirName,"onUpdate:value":a[1]||(a[1]=e=>D(v).dirName=e),options:D(y)},null,8,["value","options"])])])),_:1}),U(n,{type:"primary",onClick:f},{default:j((()=>[C("Add")])),_:1})])),_:1}),U(p,{class:"mt-16px"},{table:j((()=>[U(o,{"checked-row-keys":D(g),"onUpdate:checkedRowKeys":a[2]||(a[2]=e=>A(g)?g.value=e:null),loading:D(P),"max-height":440,data:D(b).data,columns:D(x)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:j((()=>[U(r,{"checked-row-keys":D(g),"onUpdate:checkedRowKeys":a[3]||(a[3]=e=>A(g)?g.value=e:null),data:D(b).data,options:k},null,8,["checked-row-keys","data"])])),_:1}),U(h,{show:D(w).show,"onUpdate:show":a[4]||(a[4]=e=>D(w).show=e),title:D(w).title,data:D(w).data,width:600,"min-height":488,component:D(m)},null,8,["show","title","data","component"])])}}}),Za={class:"pt-16px"},Ja={class:"flex-1"},et={class:"w-240px"},at=T("div",{class:"mt-8px text-desc"}," Some programs need to specify a secondary directory as the working directory ",-1),tt={class:"flex-1"},lt={class:"w-240px"},st=T("div",{class:"mt-12px text-desc"}," Select your working directory click Save, e.g, ThinkPHP5, Laravel ",-1),it={class:"my-16px"},nt=T("div",{class:"text-desc"},"(Base directory limit) (open_basedir)",-1),ot=T("div",{class:"text-desc"},null,-1),rt={class:"my-20px"},dt=T("div",{class:"text-desc"},null,-1),ut={class:"w-240px"},ct={class:"w-240px"},pt={class:"w-240px"},mt=L({__name:"index",setup(e,{expose:a}){const{data:l}=Ba(),i=R("");let n="";const c=async()=>{""!==i.value.trim()?i.value!==n?(await re({id:l.id,name:l.name,path:i.value}),P()):t.success("Same as original path, no need to change!"):t.error("Please select web directory")},m=R(null),h=R([]),v=async()=>{null!==m.value?(await de({id:l.id,runPath:m.value}),P()):t.error("Please select runtime directory")},y=R(!1),f=async()=>{await ue({id:l.id,path:l.path}),P()},w=R(!1),_=async()=>{await ce({id:l.id}),P()},g=R(!1),b=N({username_get:"",password_get_1:"",password_get_2:""}),x=async e=>{e||(await pe({id:l.id}),P())},k=async()=>{""!==b.username_get.trim()?""!==b.password_get_1.trim()?""!==b.password_get_2.trim()?b.username_get.trim().length<3||b.password_get_1.trim().length<3?t.error("Username cannot be less than 3 digits!"):b.password_get_1.trim()===b.password_get_2.trim()?(await me({id:l.id,username:b.username_get,password:b.password_get_1}),b.username_get="",b.password_get_1="",b.password_get_2="",P()):t.error("The passwords entered twice are inconsistent!"):t.error("Please input repeat password!"):t.error("Please input password!"):t.error("Please input username!")},P=()=>{(async()=>{const{message:e}=await he({id:l.id});o(e)&&(i.value=e.result||"/www",n=i.value)})(),(async()=>{const{message:e}=await ve({id:l.id,path:l.path});if(o(e)){m.value=r(e,"runPath.runPath",null),y.value=r(e,"userini",!1),w.value=r(e,"logs.result",!1),g.value=r(e,"pass.result",!1);const a=r(e,"runPath.dirs",[]);h.value=a.map((e=>({label:e,value:e})))}})()};return P(),a({init:P}),(e,a)=>{const t=fa,l=s,n=u,o=va,r=ha,P=p,L=pa,R=d,N=ya;return S(),E("div",Za,[U(N,{"label-width":"140"},{default:j((()=>[U(o,{label:"Site directory","show-feedback":!1},{default:j((()=>[T("div",Ja,[U(n,null,{default:j((()=>[T("div",et,[U(t,{value:D(i),"onUpdate:value":a[0]||(a[0]=e=>A(i)?i.value=e:null)},null,8,["value"])]),U(l,{type:"primary",onClick:c},{default:j((()=>[C("Save")])),_:1})])),_:1}),at])])),_:1}),U(o,{class:"mt-16px",label:"Running directory","show-feedback":!1},{default:j((()=>[T("div",tt,[U(n,null,{default:j((()=>[T("div",lt,[U(r,{value:D(m),"onUpdate:value":a[1]||(a[1]=e=>A(m)?m.value=e:null),options:D(h)},null,8,["value","options"])]),U(l,{type:"primary",onClick:v},{default:j((()=>[C("Save")])),_:1})])),_:1}),st])])),_:1}),T("div",it,[U(P,{dashed:""})]),U(o,{label:"Anti-XSS attack","show-feedback":!1},{default:j((()=>[U(n,{class:"items-center"},{default:j((()=>[U(L,{value:D(y),"onUpdate:value":[a[2]||(a[2]=e=>A(y)?y.value=e:null),f]},null,8,["value"]),nt])),_:1})])),_:1}),U(o,{class:"mt-16px",label:"Write access log","show-feedback":!1},{default:j((()=>[U(n,{class:"items-center"},{default:j((()=>[U(L,{value:D(w),"onUpdate:value":[a[3]||(a[3]=e=>A(w)?w.value=e:null),_]},null,8,["value"]),ot])),_:1})])),_:1}),T("div",rt,[U(P,{dashed:""})]),U(o,{label:"Password access","show-feedback":!1},{default:j((()=>[U(n,{class:"items-center"},{default:j((()=>[U(L,{value:D(g),"onUpdate:value":[a[4]||(a[4]=e=>A(g)?g.value=e:null),x]},null,8,["value"]),dt])),_:1})])),_:1}),D(g)?(S(),E(q,{key:0},[U(o,{class:"mt-16px",label:"Authorized account","show-feedback":!1},{default:j((()=>[T("div",ut,[U(R,{value:D(b).username_get,"onUpdate:value":a[5]||(a[5]=e=>D(b).username_get=e),placeholder:"Please leave blank if not modified"},null,8,["value"])])])),_:1}),U(o,{class:"mt-16px",label:"Password access","show-feedback":!1},{default:j((()=>[T("div",ct,[U(R,{value:D(b).password_get_1,"onUpdate:value":a[6]||(a[6]=e=>D(b).password_get_1=e),type:"password",placeholder:"Please leave blank if not modified"},null,8,["value"])])])),_:1}),U(o,{class:"mt-16px",label:"Repeat password","show-feedback":!1},{default:j((()=>[T("div",pt,[U(R,{value:D(b).password_get_2,"onUpdate:value":a[7]||(a[7]=e=>D(b).password_get_2=e),type:"password",placeholder:"Please leave blank if not modified"},null,8,["value"])])])),_:1}),U(o,{class:"mt-16px",label:" ","show-feedback":!1},{default:j((()=>[U(l,{type:"primary",onClick:k},{default:j((()=>[C("Save")])),_:1})])),_:1})],64)):B("",!0)])),_:1})])}}}),ht={class:"p-20px"},vt={class:"w-280px"},yt={class:"w-280px"},ft={class:"w-280px"},wt={class:"w-280px"},_t=T("li",null,"After the path is protected, you need to enter the account password to access it.",-1),gt=T("li",null," For example, if I set the protection directory /test/ , then I need to enter the account password to access http://aaa.com/test/ ",-1),bt=L({__name:"form",props:{data:{}},setup(e,{expose:a}){const t=e,{isEdit:l,siteId:s,row:i,getList:n}=t.data,o=R(null),r=N({name:"",site_dir:"",username:"",password:""}),u={name:{required:!0,message:"Please enter the name",trigger:["blur","input"]},site_dir:{required:!0,message:"Please enter the path",trigger:["blur","input"]},username:{required:!0,message:"Please enter the username",trigger:["blur","input"]},password:{required:!0,message:"Please enter the password",trigger:["blur","input"]}};return l&&i&&(r.name=i.name,r.site_dir=i.site_dir),a({onConfirm:async({hide:e})=>{var a;await(null==(a=o.value)?void 0:a.validate()),l?await ye({id:s,name:r.name,username:r.username,password:r.password}):await fe({...M(r),id:s}),null==n||n(),e()}}),(e,a)=>{const t=d,s=va,i=ya,n=_a;return S(),E("div",ht,[U(i,{ref_key:"formRef",ref:o,model:D(r),rules:u},{default:j((()=>[U(s,{label:"Name",path:"name"},{default:j((()=>[T("div",vt,[U(t,{value:D(r).name,"onUpdate:value":a[0]||(a[0]=e=>D(r).name=e),disabled:D(l),placeholder:""},null,8,["value","disabled"])])])),_:1}),U(s,{label:"Path",path:"site_dir"},{default:j((()=>[T("div",yt,[U(t,{value:D(r).site_dir,"onUpdate:value":a[1]||(a[1]=e=>D(r).site_dir=e),disabled:D(l),placeholder:"Enter the path: /text/，/test/api"},null,8,["value","disabled"])])])),_:1}),U(s,{label:"Username",path:"username"},{default:j((()=>[T("div",ft,[U(t,{value:D(r).username,"onUpdate:value":a[2]||(a[2]=e=>D(r).username=e),placeholder:""},null,8,["value"])])])),_:1}),U(s,{label:"Password",path:"password"},{default:j((()=>[T("div",wt,[U(t,{value:D(r).password,"onUpdate:value":a[3]||(a[3]=e=>D(r).password=e),placeholder:""},null,8,["value"])])])),_:1})])),_:1},8,["model"]),U(n,{class:"mt-4px"},{default:j((()=>[_t,gt])),_:1})])}}}),xt=T("li",null,"After setting, you need to enter the password to access it.",-1),kt=T("li",null," For example, if I set the limit path /test/, then I need to enter the account password to access http://aaa.com/test/ ",-1),Pt=L({__name:"index",setup(e,{expose:t}){const{data:l}=Ba(),{keys:n,table:r,columns:d}=Y([{type:"selection",width:40},{key:"name",title:"Name",ellipsis:{tooltip:{width:"trigger"}}},{key:"site_dir",title:"Path",ellipsis:{tooltip:{width:"trigger"}}},ca({width:130,options:e=>[{label:"Edit",onClick:()=>{f(e)}},{label:"Del",onClick:()=>{a({title:"Delete [".concat(e.name,"]"),content:"Are you sure to delete this directory?",onConfirm:async({hide:a})=>{await we({id:l.id,name:e.name}),h(),a()}})}}]})]),u=[{key:"del",type:"confirm",label:"Please choose del",confirm:{title:"Batch delete",desc:"Please be cautious, The selected item will be [delete] after confirmation",columns:[d.value[1]],api:e=>we({id:l.id,name:e.name},!1),done:()=>{h()}}}],{loading:p,setLoading:m}=da(),h=async()=>{try{m(!0);const{message:e}=await _e({id:l.id});if(o(e)){r.data=[];for(const[a,t]of Object.entries(e))if(l.name===a){r.data=t;break}}}finally{n.value=[],m(!1)}},v=i("Add limit access",{row:void 0,siteId:l.id,isEdit:!1,getList:h}),y=()=>{v.data.isEdit=!1,v.title="Add limit access",v.show=!0},f=e=>{v.data.row=e,v.data.isEdit=!0,v.title="Edit limit access",v.show=!0};return h(),t({init:h}),(e,a)=>{const t=s,l=Z,i=Q,o=G,m=_a,h=c;return S(),E("div",null,[U(o,null,{toolsLeft:j((()=>[U(t,{type:"primary",onClick:y},{default:j((()=>[C("Add limit access")])),_:1})])),table:j((()=>[U(l,{"checked-row-keys":D(n),"onUpdate:checkedRowKeys":a[0]||(a[0]=e=>A(n)?n.value=e:null),"row-key":"name",loading:D(p),"max-height":440,data:D(r).data,columns:D(d)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:j((()=>[U(i,{"checked-row-keys":D(n),"onUpdate:checkedRowKeys":a[1]||(a[1]=e=>A(n)?n.value=e:null),"row-key":"name",data:D(r).data,options:u},null,8,["checked-row-keys","data"])])),_:1}),U(m,{class:"mt-16px"},{default:j((()=>[xt,kt])),_:1}),U(h,{show:D(v).show,"onUpdate:show":a[2]||(a[2]=e=>D(v).show=e),title:D(v).title,data:D(v).data,width:480,footer:!0,component:bt},null,8,["show","title","data"])])}}}),Ut={class:"p-20px"},Ct={class:"w-280px"},Lt={class:"w-280px"},Rt={class:"w-280px"},St=T("li",null,"Name: The rule name.",-1),Et=T("li",null," Suffix: Indicates the suffix that is not allowed to access, if there are more than one, separate with'|' ",-1),Tt=T("li",null,"Path: Quote rules in this directory. e.g: /a/",-1),jt=T("li",null,"For Example, if you want to deny http://test.com/a/index.php",-1),Dt=T("li",null,"Please fill in [ /a/ ]",-1),At=L({__name:"form",props:{data:{}},setup(e,{expose:a}){const t=e,{isEdit:l,siteName:s,row:i,getList:n}=t.data,o=R(null),r=N({deny_name:"",suffix:"php|jsp",dir:""}),u={deny_name:{required:!0,message:"Please enter the name",trigger:["blur","input"]},suffix:{required:!0,message:"Please enter the path",trigger:["blur","input"]},dir:{required:!0,message:"Please enter the username",trigger:["blur","input"]}},c=()=>({...M(r),dir:r.dir.replace(/\/$/,"")+"/",website:s});return l&&i&&(r.deny_name=i.name,r.suffix=i.suffix,r.dir=i.dir),a({onConfirm:async({hide:e})=>{var a;await(null==(a=o.value)?void 0:a.validate()),l?await ge(c()):await be(c()),null==n||n(),e()}}),(e,a)=>{const t=d,s=va,i=ya,n=_a;return S(),E("div",Ut,[U(i,{ref_key:"formRef",ref:o,model:D(r),rules:u},{default:j((()=>[U(s,{label:"Name",path:"deny_name"},{default:j((()=>[T("div",Ct,[U(t,{value:D(r).deny_name,"onUpdate:value":a[0]||(a[0]=e=>D(r).deny_name=e),disabled:D(l),placeholder:"The rule name"},null,8,["value","disabled"])])])),_:1}),U(s,{label:"Suffix",path:"suffix"},{default:j((()=>[T("div",Lt,[U(t,{value:D(r).suffix,"onUpdate:value":a[1]||(a[1]=e=>D(r).suffix=e),placeholder:"Suffixes that are not allowed"},null,8,["value"])])])),_:1}),U(s,{label:"Path",path:"dir"},{default:j((()=>[T("div",Rt,[U(t,{value:D(r).dir,"onUpdate:value":a[2]||(a[2]=e=>D(r).dir=e),placeholder:"Quote rules in this directory. e.g: /a/"},null,8,["value"])])])),_:1})])),_:1},8,["model"]),U(n,{class:"mt-4px"},{default:j((()=>[St,Et,Tt,jt,Dt])),_:1})])}}}),Nt=T("li",null," Suffix: Indicates the suffix that is not allowed to access, if there are more than one, separate with'|'. ",-1),It=T("li",null,"Path: Quote rules in this directory. e.g: /a/",-1),qt=T("li",null,"For Example, if you want to deny http://test.com/a/index.php",-1),Bt=T("li",null,"Please fill in [ /a/ ]",-1),Mt=L({__name:"index",setup(e,{expose:t}){const{data:n}=Ba(),{keys:o,table:r,columns:d}=Y([{type:"selection",width:40},{key:"name",title:"Name",ellipsis:{tooltip:{width:"trigger"}}},{key:"dir",title:"Path",ellipsis:{tooltip:{width:"trigger"}}},{key:"suffix",title:"Suffix",ellipsis:{tooltip:{width:"trigger"}}},ca({width:130,options:e=>[{label:"Edit",onClick:()=>{f(e)}},{label:"Del",onClick:()=>{a({title:"Delete [".concat(e.name,"]"),content:"Are you sure to delete this directory?",onConfirm:async({hide:a})=>{await xe({website:n.name,deny_name:e.name}),h(),a()}})}}]})]),u=[{key:"del",type:"confirm",label:"Please choose del",confirm:{title:"Batch delete",desc:"Please be cautious, The selected item will be [delete] after confirmation",columns:[d.value[1]],api:e=>xe({website:n.name,deny_name:e.name},!1),done:()=>{h()}}}],{loading:p,setLoading:m}=da(),h=async()=>{try{m(!0);const{message:e}=await ke({website:n.name});r.data=l(e)?e:[]}finally{o.value=[],m(!1)}},v=i("Add limit access",{row:void 0,siteName:n.name,isEdit:!1,getList:h}),y=()=>{v.data.row=void 0,v.data.isEdit=!1,v.title="Add limit access",v.show=!0},f=e=>{v.data.row=e,v.data.isEdit=!0,v.title="Edit limit access",v.show=!0};return h(),t({init:h}),(e,a)=>{const t=s,l=Z,i=Q,n=G,m=_a,h=c;return S(),E("div",null,[U(n,null,{toolsLeft:j((()=>[U(t,{type:"primary",onClick:y},{default:j((()=>[C("Add deny access")])),_:1})])),table:j((()=>[U(l,{"checked-row-keys":D(o),"onUpdate:checkedRowKeys":a[0]||(a[0]=e=>A(o)?o.value=e:null),"row-key":"name",loading:D(p),"max-height":440,data:D(r).data,columns:D(d)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:j((()=>[U(i,{"checked-row-keys":D(o),"onUpdate:checkedRowKeys":a[1]||(a[1]=e=>A(o)?o.value=e:null),"row-key":"name",data:D(r).data,options:u},null,8,["checked-row-keys","data"])])),_:1}),U(m,{class:"mt-16px"},{default:j((()=>[Nt,It,qt,Bt])),_:1}),U(h,{show:D(v).show,"onUpdate:show":a[2]||(a[2]=e=>D(v).show=e),title:D(v).title,data:D(v).data,width:480,footer:!0,component:At},null,8,["show","title","data"])])}}}),Ht=L({__name:"index",setup(e){const a=R("limit"),t=[{key:"limit",label:"Limit access",component:Pt},{key:"deny",label:"Deny access",component:Mt}];return(e,l)=>{const s=wa;return S(),H(s,{value:D(a),"onUpdate:value":l[0]||(l[0]=e=>A(a)?a.value=e:null),data:t},null,8,["value"])}}}),Kt={class:"pt-8px"},Ot={class:"w-200px"},zt={class:"flex flex-col"},Wt={class:"w-200px"},Vt=T("div",{class:"mt-8px text-desc"},"* Limit of max concurrency",-1),Ft={class:"flex flex-col"},Xt={class:"w-200px"},$t=T("div",{class:"mt-8px text-desc"},"* Limit of single IP accessing max concurrency",-1),Gt={class:"flex flex-col"},Qt={class:"w-200px"},Yt=T("div",{class:"mt-8px text-desc"},"* Limit the max traffic limit per request (unit: KB)",-1),Zt=L({__name:"index",setup(e,{expose:a}){const{data:t}=Ba(),l=R(null),i=N({status:!1,type:0,perserver:300,perip:25,limit_rate:512}),n={perserver:{trigger:["blur","change"],validator:()=>!!i.perserver||new Error("请输入并发限制")},perip:{trigger:["blur","change"],validator:()=>!!i.perip||new Error("请输入单IP限制")},limit_rate:{trigger:["blur","change"],validator:()=>!!i.limit_rate||new Error("请输入流量限制")}},r=R([{label:"BBS/Blog",value:0,items:{perserver:300,perip:25,limit_rate:512}},{label:"Photofolio",value:1,items:{perserver:200,perip:10,limit_rate:1024}},{label:"Download",value:2,items:{perserver:50,perip:3,limit_rate:2048}},{label:"Mall",value:3,items:{perserver:500,perip:10,limit_rate:2048}},{label:"Portal",value:4,items:{perserver:400,perip:15,limit_rate:1024}},{label:"Corporate",value:5,items:{perserver:60,perip:10,limit_rate:512}},{label:"Video",value:6,items:{perserver:150,perip:4,limit_rate:1024}},{label:"Customize",value:7,items:{perserver:0,perip:0,limit_rate:0}}]),d=async e=>{e?p():(await Pe({id:t.id}),v())},u=(e,a)=>{const{items:t}=a;o(t)&&c(t)},c=e=>{i.perserver=e.perserver,i.perip=e.perip,i.limit_rate=e.limit_rate},p=async()=>{var e;await(null==(e=l.value)?void 0:e.validate()),await Ue({id:t.id,perserver:i.perserver,perip:i.perip,limit_rate:i.limit_rate}),v()},v=async()=>{const{message:e}=await Ce({id:t.id});o(e)&&(i.status=0!=e.perserver,c(r.value[0].items),m(e.perserver)&&0!=e.perserver&&(i.perserver=e.perserver),m(e.perip)&&0!=e.perip&&(i.perip=e.perip),m(e.limit_rate)&&0!=e.limit_rate&&(i.limit_rate=e.limit_rate))};return v(),a({init:v}),(e,a)=>{const t=ga,o=va,c=ha,m=h,v=s,y=ya;return S(),E("div",Kt,[U(y,{ref_key:"formRef",ref:l,"label-width":"150",class:"px-8px",model:D(i),rules:n},{default:j((()=>[U(o,{label:" "},{default:j((()=>[U(t,{checked:D(i).status,"onUpdate:checked":[a[0]||(a[0]=e=>D(i).status=e),d]},{default:j((()=>[C(" Turn on traffic control ")])),_:1},8,["checked"])])),_:1}),U(o,{label:"Limit plan",path:"type"},{default:j((()=>[T("div",Ot,[U(c,{value:D(i).type,"onUpdate:value":[a[1]||(a[1]=e=>D(i).type=e),u],options:D(r)},null,8,["value","options"])])])),_:1}),U(o,{label:"Limit of concurrency",path:"perserver"},{default:j((()=>[T("div",zt,[T("div",Wt,[U(m,{value:D(i).perserver,"onUpdate:value":a[2]||(a[2]=e=>D(i).perserver=e),"show-button":!1,min:0},null,8,["value"])]),Vt])])),_:1}),U(o,{label:"Block single IP",path:"perip"},{default:j((()=>[T("div",Ft,[T("div",Xt,[U(m,{value:D(i).perip,"onUpdate:value":a[3]||(a[3]=e=>D(i).perip=e),"show-button":!1,min:0},null,8,["value"])]),$t])])),_:1}),U(o,{label:"Traffic control",path:"limit_rate"},{default:j((()=>[T("div",Gt,[T("div",Qt,[U(m,{value:D(i).limit_rate,"onUpdate:value":a[4]||(a[4]=e=>D(i).limit_rate=e),"show-button":!1,min:0},null,8,["value"])]),Yt])])),_:1}),U(o,{label:" "},{default:j((()=>[U(v,{type:"primary",onClick:p},{default:j((()=>[C("Save")])),_:1})])),_:1})])),_:1},8,["model"])])}}}),Jt={class:"w-420px"},el={class:"mt-8px"},al=T("li",null,"Default indexes, one per line, priority top-to-bottom.",-1),tl=L({__name:"index",setup(e,{expose:a}){const{data:t}=Ba(),l=R(""),i=async()=>{const{message:e}=await Le({id:t.id});o(e)&&(l.value=v(e.result)?e.result.split(",").join("\n"):"")},n=async()=>{await Re({id:t.id,Index:l.value.trim().split("\n").join(",")}),i()};return i(),a({init:i}),(e,a)=>{const t=d,i=s,o=_a;return S(),E("div",null,[T("div",Jt,[U(t,{value:D(l),"onUpdate:value":a[0]||(a[0]=e=>A(l)?l.value=e:null),type:"textarea",autosize:{minRows:12,maxRows:12},placeholder:""},null,8,["value"])]),T("div",el,[U(i,{type:"primary",onClick:n},{default:j((()=>[C("Save")])),_:1})]),U(o,{class:"mt-16px"},{default:j((()=>[al])),_:1})])}}}),ll={class:"mt-8px"},sl=T("li",null,"This is primary configuration file of the site.",-1),il=T("li",null,"Do not modify it at will if you do not know configuration rules.",-1),nl=L({__name:"index",setup(e,{expose:a}){const{data:t}=Ba(),l=y(),i=R(null),n=R((()=>{const{webserver:e}=l,a="openlitespeed"===e?"".concat(e,"/detail"):e;return"/www/server/panel/vhost/".concat(a,"/").concat(t.name,".conf")})()),o=async()=>{var e;null==(e=i.value)||e.getContent()},r=()=>{var e;null==(e=i.value)||e.saveFile()};return K((()=>{o()})),a({init:o}),(e,a)=>{const t=s,l=_a;return S(),E("div",null,[U(xa,{ref_key:"configRef",ref:i,path:D(n),"onUpdate:path":a[0]||(a[0]=e=>A(n)?n.value=e:null),height:"500"},null,8,["path"]),T("div",ll,[U(t,{type:"primary",onClick:r},{default:j((()=>[C("Save")])),_:1})]),U(l,{class:"mt-16px"},{default:j((()=>[sl,il])),_:1})])}}}),ol={class:"p-8"},rl=T("li",null,"Directory temporarily only supports reading alarm operation",-1),dl=L({__name:"form",setup(e,{expose:a}){const t=R(null),l=R(!1),s={path:{required:!0,message:"Please select the file directory",trigger:["blur","change"]},operation:{type:"array",required:!0,trigger:"change",message:"please select"}},i=N({path:"",operation:[]}),n=(e,a)=>{"dir"===a.type?(l.value=!0,i.operation=[0]):(l.value=!1,i.operation=[0,1,2])};return a({onConfirm:async()=>{var e;await(null==(e=t.value)?void 0:e.validate())}}),(e,a)=>{const o=fa,r=va,d=ga,c=Ta,p=ba,m=ya,h=u,v=_a;return S(),E("div",ol,[U(h,null,{default:j((()=>[U(m,{ref_key:"formRef",ref:t,model:D(i),rules:s},{default:j((()=>[U(r,{label:"Detection path",path:"path"},{default:j((()=>[U(o,{disabled:"",value:D(i).path,"onUpdate:value":a[0]||(a[0]=e=>D(i).path=e),"checked-type":["dir","file"],placeholder:"Please select the file directory",onChange:n},null,8,["value"])])),_:1}),U(r,{label:"Alert operation",path:"operation"},{default:j((()=>[U(p,{value:D(i).operation,"onUpdate:value":a[1]||(a[1]=e=>D(i).operation=e)},{default:j((()=>[U(c,null,{default:j((()=>[U(d,{value:0},{default:j((()=>[C(" Read ")])),_:1}),U(d,{value:1,disabled:D(l)},{default:j((()=>[C(" delete ")])),_:1},8,["disabled"]),U(d,{value:2,disabled:D(l)},{default:j((()=>[C(" Modify/increase ")])),_:1},8,["disabled"])])),_:1})])),_:1},8,["value"])])),_:1})])),_:1},8,["model"])])),_:1}),U(v,{class:"mt-16px"},{default:j((()=>[rl])),_:1})])}}}),ul={class:"p-5"},cl=T("img",{src:Pa,class:"w-5"},null,-1),pl={class:"mt-16px"},ml=T("li",null," The security alarm will monitor the behavior of the current website access to the non -current website file (for example: your site a.COM visited the file or directory of the site B.COM). ",-1),hl=T("li",null,"Police frequency: 60 seconds of alarm behavior will only send an alarm once",-1),vl=L({__name:"monitor",setup(e){const a=R(!1),t=R(!1),l=R([{key:"path",title:"path",ellipsis:{tooltip:{width:"trigger"}}},{key:"type",title:"type",ellipsis:{tooltip:{width:"trigger"}}},{key:"operation",title:"Alert operation",ellipsis:{tooltip:{width:"trigger"}}},{key:"name",title:"operate",ellipsis:{tooltip:{width:"trigger"}}}]),i=R([]);return(e,n)=>{const o=s,r=u,d=Z,p=_a,m=c;return S(),E("div",ul,[T("div",null,[U(r,{justify:"space-between"},{default:j((()=>[U(o,{type:"primary",onClick:n[0]||(n[0]=e=>a.value=!0)},{default:j((()=>[C(" Add monitor ")])),_:1}),U(o,null,{icon:j((()=>[cl])),_:1})])),_:1})]),T("div",pl,[U(d,{loading:D(t),"loading-num":6,data:D(i),columns:D(l)},null,8,["loading","data","columns"])]),T("div",null,[U(p,{class:"mt-16px"},{default:j((()=>[ml,hl,T("li",null,[U(o,{text:"",class:"color-#20a53a"},{default:j((()=>[C("Tutorial")])),_:1})])])),_:1})]),U(m,{show:D(a),"onUpdate:show":n[1]||(n[1]=e=>A(a)?a.value=e:null),title:"Add file monitor",width:500,"min-height":148,footer:!0,component:dl},null,8,["show"])])}}});const yl=f({},[["render",function(e,a){return S(),E("div",null,"555")}]]),fl=e=>(W("data-v-24287f9c"),e=e(),V(),e),wl={class:"box mt-16px"},_l=fl((()=>T("div",null,"Site protection",-1))),gl=fl((()=>T("div",null,"today: 0",-1))),bl=fl((()=>T("div",null,"Total alarm: 0",-1))),xl={key:0,class:"items-center warning"},kl=fl((()=>T("img",{src:Ca,class:"h-8"},null,-1))),Pl={class:"warning"},Ul={class:"color-#f23836"},Cl=fl((()=>T("li",null," Based on the PHP kernel monitoring tools, real -time monitoring of other invasive behaviors such as Trojan horses and vulnerabilities, I found that Trojan supports automatic isolation ",-1))),Ll=fl((()=>T("li",null," The security alarm will monitor the behavior of the current website access to the non -current website file (for example: your site a.COM visited the file or directory of the site B.COM). When you wait for a cache, please do not turn on this option ",-1))),Rl=fl((()=>T("img",{src:Ua,class:"h-10"},null,-1))),Sl=f(L({__name:"index",props:{isInstall:{type:Boolean,default:!1},phpVersion:{default:"PHP"}},setup(t){const l=y(),i=R(!1),n=R(!1),o=R(!1),r=t,d=w(),p=()=>{Ra({source:114})},m=()=>{const e=i.value?"Open the site security alarm":"Close the site security alarm",t=i.value?"After opening, the alarm notice will be sent when the safety problem is detected. Do you continue?":"After closing, the website will no longer receive a security alarm. Do you continue?";a({title:e,content:t,onConfirm:async()=>{const e=Sa(i.value);console.log(e,"result")},onPublicClose:()=>{i.value=!i.value}})};return(a,t)=>{const h=pa,v=u,y=s,f=_a,w=e,_=ka,g=c;return S(),E(q,null,[T("div",wl,[U(_,{install:D(d).isPro,class:"install"},O({default:j((()=>[U(v,{class:"items-center color-#666"},{default:j((()=>[_l,T("div",null,[U(h,{value:D(i),"onUpdate:value":[t[0]||(t[0]=e=>A(i)?i.value=e:null),m]},null,8,["value"])]),gl,bl,D(i)?B("",!0):(S(),E("div",xl,[kl,T("span",Pl,[C(" Please open "),T("span",Ul,"PHP-"+z(r.phpVersion),1),C(" protection first ")])]))])),_:1}),U(v,{class:"mt-16px"},{default:j((()=>[U(y,{onClick:t[1]||(t[1]=e=>n.value=!0)},{default:j((()=>[C("Monitor")])),_:1}),U(y,{onClick:t[2]||(t[2]=e=>o.value=!0)},{default:j((()=>[C("Trigger log")])),_:1})])),_:1}),U(f,{class:"mt-16px"},{default:j((()=>[Cl,Ll])),_:1})])),_:2},[r.isInstall?{name:"desc",fn:j((()=>[U(v,{class:"items-center"},{default:j((()=>[Rl,T("span",null,[C("If you need to use the [PHP website security alarm] function, please buy first "),U(w,{onClick:p},{default:j((()=>[C("click to buy")])),_:1})])])),_:1})])),key:"0"}:{name:"desc",fn:j((()=>[U(v,{class:"items-center"},{default:j((()=>[T("img",{src:Ua,class:"h-10"}),T("span",null,[C("Currently not installed [PHP website security alarm], "),U(w,null,{default:j((()=>[C("Click to install")])),_:1})])])),_:1})])),key:"1"}]),1032,["install"])]),U(g,{show:D(n),"onUpdate:show":t[3]||(t[3]=e=>A(n)?n.value=e:null),title:"XXXXmonitor",width:1e3,"min-height":148,footer:!1,component:vl},null,8,["show"]),U(g,{show:D(o),"onUpdate:show":t[4]||(t[4]=e=>A(o)?o.value=e:null),title:"[".concat(D(l).siteName,"] Site security log"),width:1e3,"min-height":148,footer:!1,component:yl},null,8,["show","title"])],64)}}}),[["__scopeId","data-v-24287f9c"]]),El=T("div",null,"PHP version",-1),Tl={class:"w-140px"},jl=T("li",null,"Select the version according to your program requirements",-1),Dl=T("li",null,"Try not to use PHP5.2 unless you have to, as this can reduce your server security",-1),Al=T("li",null," PHP7 does not support the MySQL extension. The default installation is mysqli and mysql-pdo ",-1),Nl=T("li",null," [Customize] You can customize the PHP connection information by selecting the available PHP connection configuration ",-1),Il=T("li",null,"[Customize] Currently only support NGINX",-1),ql=T("li",null,"Support TCP or UNIX configuration. Example: 192.168.1.25:9001 or unix:/tmp/php8.sock",-1),Bl={class:"my-16px"},Ml=T("div",null,"Session isolation",-1),Hl=T("li",null," When enabled, session files will be stored in a separate folder, not in a common storage location with other sites ",-1),Kl=T("li",null," Do not enable this option if you are saving sessions to caches such as memcache/redis in your PHP configuration ",-1),Ol={key:0,class:"my-16px"},zl=L({__name:"index",setup(e,{expose:a}){const{data:i}=Ba(),n=y(),r=R(null),d=R(!1),c=R(!1);let m="";const h=R([]),v=async()=>{null!==r.value?(await Se({siteName:i.name,version:r.value,other:m}),n.setRefresh(!0),g()):t.error("请选择PHP版本")},f=async()=>{const{message:e}=await De({id:i.id});o(e)&&(d.value=e.result)},w=async e=>{await Ee({id:i.id,act:e?1:0}),f()},g=()=>{(async()=>{const{message:e}=await Ea();o(e)&&(c.value=e.php_status)})(),f(),(async()=>{const{message:e}=await je();l(e)&&(h.value=e.reverse().map((e=>({label:e.name,value:e.version}))))})(),(async()=>{const{message:e}=await Te({siteName:i.name});o(e)&&(r.value=e.phpversion,m=e.php_other||"")})()};return g(),a({init:g}),(e,a)=>{const t=ha,l=s,i=u,n=_a,o=p,m=pa;return S(),E("div",null,[U(i,{class:"items-center"},{default:j((()=>[El,T("div",Tl,[U(t,{value:D(r),"onUpdate:value":a[0]||(a[0]=e=>A(r)?r.value=e:null),options:D(h)},null,8,["value","options"])]),T("div",null,[U(l,{type:"primary",onClick:v},{default:j((()=>[C("Switch")])),_:1})])])),_:1}),U(n,{class:"mt-16px"},{default:j((()=>[jl,Dl,Al,Nl,Il,ql])),_:1}),T("div",Bl,[U(o,{dashed:""})]),U(i,{class:"items-center"},{default:j((()=>[Ml,T("div",null,[U(m,{value:D(d),"onUpdate:value":[a[1]||(a[1]=e=>A(d)?d.value=e:null),w]},null,8,["value"])])])),_:1}),U(n,{class:"mt-16px"},{default:j((()=>[Hl,Kl])),_:1}),D(_)?(S(),E("div",Ol,[U(o,{dashed:""}),U(Sl,{isInstall:D(c),phpVersion:D(r)},null,8,["isInstall","phpVersion"])])):B("",!0)])}}}),Wl={class:"mr-16px text-#777"},Vl={key:1,class:"text-#777"},Fl={class:"w-200px mr-8px"},Xl={class:"w-200px mr-8px"},$l=L({__name:"index",setup(e,{expose:a}){const i=y(),{data:n}=Ba(),r=R(!1),u=R("--"),c=R("--"),p=R(n.cache_status),m=R(null),h=R([]),v=R(""),f=async()=>{await Ae({s_id:n.id,version:c.value}),b()},w=async e=>{await Ne({version:n.php_version,sitename:n.name,act:e}),n.cache_status=e,i.setRefresh(!0)},_=async()=>{await Ie({s_id:n.id})},g=async()=>{m.value?""!==v.value.trim()?await qe({s_id:n.id,user:m.value,new_pass:v.value}):t.error("Please enter new password"):t.error("Please select user")},b=async()=>{const e=t.loading("Getting Wordpress information, please wait...");try{await(async()=>{const{message:e}=await Be({s_id:n.id});o(e)&&(u.value=e.local_v,c.value=e.online_v,r.value=e.update)})(),await(async()=>{const{message:e}=await Me({s_id:n.id});l(e)&&e.length>0?(h.value=e.map((e=>({label:e,value:e}))),m.value=e[0]):(h.value=[],m.value=null)})()}finally{e.close()}};return b(),a({init:b}),(e,a)=>{const t=s,l=va,i=ga,n=ha,o=d,y=ya;return S(),E("div",null,[U(y,null,{default:j((()=>[U(l,{label:"WP Version"},{default:j((()=>[D(r)?(S(),E(q,{key:0},[T("div",Wl,"The current version is: "+z(D(u)),1),U(t,{type:"primary",onClick:f},{default:j((()=>[C("Upgrade to "+z(D(c)),1)])),_:1})],64)):(S(),E("span",Vl,"The latest version"))])),_:1}),U(l,{label:"Cache"},{default:j((()=>[U(i,{checked:D(p),"onUpdate:checked":[a[0]||(a[0]=e=>A(p)?p.value=e:null),w],class:"mr-16px"},{default:j((()=>[C(" Open cache ")])),_:1},8,["checked"]),U(t,{type:"primary",onClick:_},{default:j((()=>[C("Purge all cache")])),_:1})])),_:1}),U(l,{label:"Reset password"},{default:j((()=>[T("div",Fl,[U(n,{value:D(m),"onUpdate:value":a[1]||(a[1]=e=>A(m)?m.value=e:null),options:D(h)},null,8,["value","options"])]),T("div",Xl,[U(o,{value:D(v),"onUpdate:value":a[2]||(a[2]=e=>A(v)?v.value=e:null),placeholder:"Please enter a new password"},null,8,["value"])]),U(t,{type:"primary",onClick:g},{default:j((()=>[C("Save password")])),_:1})])),_:1})])),_:1})])}}}),Gl={class:"pt-8px"},Ql={class:"w-180px mr-8px"},Yl={class:"w-180px"},Zl={class:"w-180px"},Jl={class:"w-280px"},es={class:"w-180px"},as={class:"w-180px"},ts={class:"w-280px"},ls={class:"flex-1"},ss={key:0,class:"mb-16px text-error"},is={key:1,class:"mb-16px text-error"},ns=L({__name:"index",setup(t,{expose:l}){const{data:i}=Ba(),n=N({composer_version:"",php_version:"auto",composer_args:"install",composer_cmd:"",repo:"repos.packagist",composer_user:"www",composer_path:i.path}),r=R([]),u=[{label:"Install",value:"install"},{label:"Update",value:"update"}],c=[{label:"Official(packagist.org)",value:"repos.packagist"}],p=[{label:"www(recommend)",value:"www"},{label:"root(not suggested)",value:"root"}],m=R(""),h=R(""),y=async()=>{await He({repo:n.repo}),g()},f=async()=>{await Ke({path:i.path}),g()},w=()=>{a({title:"Execute Composer",content:"The impact of Composer execution depends on the composer.json configuration file in this directory, Continue?",onConfirm:async()=>{await Oe({php_version:n.php_version,composer_args:n.composer_args,composer_cmd:n.composer_cmd,repo:n.repo,path:n.composer_path,user:n.composer_user}),g()}})},_=()=>{r.value.unshift({label:"Auto",value:"auto"})},g=async()=>{const{message:e}=await ze({path:i.path});o(e)&&(n.composer_version=e.result,e.comp_json&&(m.value=e.comp_json),v(e.comp_lock)&&(h.value=e.comp_lock),r.value=e.php_versions.filter((e=>"00"!==e.version)).map((e=>({label:e.name,value:e.version}))),_())};return _(),g(),l({init:g}),(a,t)=>{const l=d,i=s,o=va,v=ha,_=fa,g=e,b=ya;return S(),E("div",Gl,[U(b,{class:"px-8px"},{default:j((()=>[U(o,{label:"Version",path:"composer_version"},{default:j((()=>[T("div",Ql,[U(l,{value:D(n).composer_version,"onUpdate:value":t[0]||(t[0]=e=>D(n).composer_version=e),disabled:!0,placeholder:""},null,8,["value"])]),U(i,{onClick:y},{default:j((()=>[C("Update")])),_:1})])),_:1}),U(o,{label:"PHP",path:"php_version"},{default:j((()=>[T("div",Yl,[U(v,{value:D(n).php_version,"onUpdate:value":t[1]||(t[1]=e=>D(n).php_version=e),options:D(r)},null,8,["value","options"])])])),_:1}),U(o,{label:"Parameters",path:"composer_args"},{default:j((()=>[T("div",Zl,[U(v,{value:D(n).composer_args,"onUpdate:value":t[2]||(t[2]=e=>D(n).composer_args=e),options:u},null,8,["value"])])])),_:1}),U(o,{label:"Extra commands",path:"composer_cmd"},{default:j((()=>[T("div",Jl,[U(l,{value:D(n).composer_cmd,"onUpdate:value":t[3]||(t[3]=e=>D(n).composer_cmd=e),placeholder:"App name or full Composer command"},null,8,["value"])])])),_:1}),U(o,{label:"Source",path:"repo"},{default:j((()=>[T("div",es,[U(v,{value:D(n).repo,"onUpdate:value":t[4]||(t[4]=e=>D(n).repo=e),options:c},null,8,["value"])])])),_:1}),U(o,{label:"User",path:"composer_user"},{default:j((()=>[T("div",as,[U(v,{value:D(n).composer_user,"onUpdate:value":t[5]||(t[5]=e=>D(n).composer_user=e),options:p},null,8,["value"])])])),_:1}),U(o,{label:"Dir",path:"composer_path"},{default:j((()=>[T("div",ts,[U(_,{value:D(n).composer_path,"onUpdate:value":t[6]||(t[6]=e=>D(n).composer_path=e)},null,8,["value"])])])),_:1}),U(o,{label:" ","show-feedback":!1},{default:j((()=>[T("div",ls,[D(m)?(S(),E("div",ss,z(D(m)),1)):B("",!0),D(h)?(S(),E("div",is,[T("span",null,z(D(h)),1),U(g,{onClick:f},{default:j((()=>[C("[Delete]")])),_:1})])):B("",!0),U(i,{type:"primary",onClick:w},{default:j((()=>[C("Execute")])),_:1})])])),_:1})])),_:1})])}}}),os={class:"px-20px py-24px"},rs={class:"w-120px"},ds={class:"w-120px"},us={class:"w-200px"},cs={class:"w-200px"},ps={class:"w-200px"},ms=T("li",null," Type: The domain name selected or the path entered will be redirected to the specified URL ",-1),hs=T("li",null,"Target URL: Fill in the URL address you need to redirect to",-1),vs=T("li",null,"Mode: use 301 for permanent redirection and 302 for temporary redirection",-1),ys=T("li",null," Keep URI parameters: Whether the redirected URL has the sub-path or parameters of the source URL ",-1),fs=T("li",null,"Keep URI parameters: http://b.com/1.html ---\x3e http://a.com/1.html",-1),ws=T("li",null,"NOT Keep URI parameters: http://b.com/1.html ---\x3e http://a.com",-1),_s=L({__name:"form",props:{data:{}},setup(e,{expose:a}){const t=e,{isEdit:s,siteId:i,siteName:n,row:o,getList:r}=t.data,c=R(null),p=N({redirectname:"".concat((new Date).valueOf()),type:1,holdpath:1,domainorpath:"domain",redirecttype:"301",redirectpath:"",redirectdomain:[],tourl:"http://"}),m={redirectdomain:{trigger:["change"],validator:()=>0!==p.redirectdomain.length||new Error("Please select redirected domain")},redirectpath:{trigger:["blur","input"],validator:()=>""!==p.redirectpath.trim()||new Error("Please input redirect path")},tourl:{trigger:["blur","input"],validator:()=>""!==p.tourl.trim()||new Error("Please input target url")}},h=[{label:"Domain name",value:"domain"},{label:"Path",value:"path"}],v=[{label:"301",value:"301"},{label:"302",value:"302"}],y=R([]),f=()=>{p.redirectdomain=[],p.redirectpath=""},{loading:w,setLoading:_}=da();return s&&o&&(p.redirectname=o.redirectname,p.type=o.type,p.holdpath=o.holdpath,p.redirecttype=o.redirecttype,p.redirectpath=o.redirectpath,p.domainorpath=o.domainorpath,p.redirectdomain=o.redirectdomain,p.tourl=o.tourl),(async()=>{try{_(!0);const{message:e}=await te({id:i});y.value=l(e)?e.map((e=>({label:e.name,value:e.name}))):[]}finally{_(!1)}})(),a({onConfirm:async({hide:e})=>{var a;await(null==(a=c.value)?void 0:a.validate());const t={...M(p),sitename:n};s?await Ve(t):await We(t),null==r||r(),e()}}),(e,a)=>{const t=pa,l=va,s=u,i=ha,n=d,o=ya,r=_a;return S(),E("div",os,[U(o,{ref_key:"formRef",ref:c,model:D(p),rules:m},{default:j((()=>[U(s,{size:60},{default:j((()=>[U(l,{label:"Enable"},{default:j((()=>[U(t,{value:D(p).type,"onUpdate:value":a[0]||(a[0]=e=>D(p).type=e),"checked-value":1,"unchecked-value":0},null,8,["value"])])),_:1}),U(l,{label:"Keep URI param","label-width":"120"},{default:j((()=>[U(t,{value:D(p).holdpath,"onUpdate:value":a[1]||(a[1]=e=>D(p).holdpath=e),"checked-value":1,"unchecked-value":0},null,8,["value"])])),_:1})])),_:1}),U(s,{size:30},{default:j((()=>[U(l,{label:"Type"},{default:j((()=>[T("div",rs,[U(i,{value:D(p).domainorpath,"onUpdate:value":[a[2]||(a[2]=e=>D(p).domainorpath=e),f],options:h},null,8,["value"])])])),_:1}),U(l,{label:"Mode","label-width":"70"},{default:j((()=>[T("div",ds,[U(i,{value:D(p).redirecttype,"onUpdate:value":a[3]||(a[3]=e=>D(p).redirecttype=e),options:v},null,8,["value"])])])),_:1})])),_:1}),"domain"===D(p).domainorpath?(S(),H(l,{key:0,label:"Source",path:"redirectdomain"},{default:j((()=>[T("div",us,[U(i,{value:D(p).redirectdomain,"onUpdate:value":a[4]||(a[4]=e=>D(p).redirectdomain=e),multiple:!0,loading:D(w),options:D(y),"max-tag-count":"responsive",placeholder:"Select domain"},null,8,["value","loading","options"])])])),_:1})):B("",!0),"path"===D(p).domainorpath?(S(),H(l,{key:1,label:"Redirect path",path:"redirectpath"},{default:j((()=>[T("div",cs,[U(n,{value:D(p).redirectpath,"onUpdate:value":a[5]||(a[5]=e=>D(p).redirectpath=e),placeholder:""},null,8,["value"])])])),_:1})):B("",!0),U(l,{label:"Target URL",path:"tourl"},{default:j((()=>[T("div",ps,[U(n,{value:D(p).tourl,"onUpdate:value":a[6]||(a[6]=e=>D(p).tourl=e),placeholder:""},null,8,["value"])])])),_:1})])),_:1},8,["model"]),U(r,{class:"mt-12px"},{default:j((()=>[ms,hs,vs,ys,fs,ws])),_:1})])}}}),gs={class:"p-20px"},bs={class:"mt-12px"},xs=T("li",null," This is the configuration file of the load balancing. Not modify if you do not understand the configuration rules. ",-1),ks=L({__name:"config",props:{data:{}},emits:["close"],setup(e,{emit:a}){const l=e,{row:i,siteName:n,getList:r}=l.data,d=a,u=y(),c=R(""),p=R(""),m=R(""),h=async()=>{const{message:e}=await Xe({path:m.value,data:c.value,encoding:p.value});o(e)&&t.success(e.msg),null==r||r(),d("close")};return(async()=>{const{message:e}=await Fe({sitename:n,redirectname:i.redirectname,webserver:u.webserver});o(e)&&(m.value=e.file,c.value=e.data,p.value=e.encoding)})(),(e,a)=>{const t=s,l=_a;return S(),E("div",gs,[U(xa,{value:D(c),"onUpdate:value":a[0]||(a[0]=e=>A(c)?c.value=e:null),height:350,"show-tips":!1},null,8,["value"]),T("div",bs,[U(t,{type:"primary",onClick:h},{default:j((()=>[C("Save")])),_:1})]),U(l,{class:"mt-24px"},{default:j((()=>[xs])),_:1})])}}}),Ps=L({__name:"index",setup(t,{expose:n}){const{data:o}=Ba(),r=e=>({sitename:e.sitename,redirectname:e.redirectname,tourl:e.tourl,redirectdomain:e.redirectdomain,redirectpath:e.redirectpath,redirecttype:e.redirecttype,domainorpath:e.domainorpath}),{keys:d,table:u,columns:p}=Y([{type:"selection",width:40},{key:"sitename",title:"Type",ellipsis:{tooltip:{width:"trigger"}}},{key:"redirecttype",title:"Mode",width:90},{key:"holdpath",title:"Keep URI param",width:140,render:a=>U(e,{type:1===a.holdpath?"primary":"error",onClick:async()=>{await $e({...r(a),type:a.type,holdpath:1===a.holdpath?0:1,status:a.type}),a.holdpath=1===a.holdpath?0:1}},{default:()=>[1===a.holdpath?"Enable":"Turn off"]})},{key:"type",title:"Status",width:100,render:e=>U(ma,{value:e.type,"checked-value":1,"unchecked-value":0,"checked-title":"Running","unchecked-title":"Paused",onClick:async a=>{await $e({...r(e),type:a,holdpath:e.holdpath,status:e.type}),e.type=a}},null)},ca({width:120,options:e=>[{label:"Conf",onClick:()=>{b(e)}},{label:"Edit",onClick:()=>{_(e)}},{label:"Del",onClick:()=>{a({title:"Delete redirection [".concat(e.redirectname,"]"),content:"Are you sure to delete the redirection?",onConfirm:async({hide:a})=>{await Ge({sitename:o.name,redirectname:e.redirectname}),y(),a()}})}}]})]),m=[{key:"del",type:"confirm",label:"Please choose del",confirm:{title:"Batch delete",desc:"Please be cautious, The selected item will be [delete] after confirmation",columns:[p.value[1]],api:e=>Ge({sitename:o.name,redirectname:e.redirectname},!1),done:()=>{y()}}}],{loading:h,setLoading:v}=da(),y=async()=>{try{v(!0);const{message:e}=await Qe({sitename:o.name});u.data=l(e)?e:[]}finally{d.value=[],v(!1)}},f=i("Create redirection",{row:void 0,siteId:o.id,siteName:o.name,isEdit:!1,getList:y}),w=()=>{f.data.row=void 0,f.data.isEdit=!1,f.title="Create redirection",f.show=!0},_=e=>{f.data.row=e,f.data.isEdit=!0,f.title="Modify redirection [".concat(e.redirectname,"]"),f.show=!0},g=i("",{row:void 0,siteName:o.name,getList:y}),b=e=>{g.data.row=e,g.title="Edit profile [".concat(e.redirectname,"]"),g.show=!0};return y(),n({init:y}),(e,a)=>{const t=s,l=Z,i=Q,n=G,o=c;return S(),E("div",null,[U(n,null,{toolsLeft:j((()=>[U(t,{type:"primary",onClick:w},{default:j((()=>[C("Add redirection")])),_:1})])),table:j((()=>[U(l,{"checked-row-keys":D(d),"onUpdate:checkedRowKeys":a[0]||(a[0]=e=>A(d)?d.value=e:null),"row-key":"redirectname",loading:D(h),"max-height":440,data:D(u).data,columns:D(p)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:j((()=>[U(i,{"checked-row-keys":D(d),"onUpdate:checkedRowKeys":a[1]||(a[1]=e=>A(d)?d.value=e:null),"row-key":"redirectname",data:D(u).data,options:m},null,8,["checked-row-keys","data"])])),_:1}),U(o,{show:D(f).show,"onUpdate:show":a[2]||(a[2]=e=>D(f).show=e),title:D(f).title,data:D(f).data,width:660,footer:!0,component:_s},null,8,["show","title","data"]),U(o,{show:D(g).show,"onUpdate:show":a[3]||(a[3]=e=>D(g).show=e),title:D(g).title,data:D(g).data,width:580,component:ks},null,8,["show","title","data"])])}}}),Us={class:"px-20px py-24px"},Cs={class:"w-220px"},Ls={class:"w-220px"},Rs={class:"w-220px"},Ss={class:"w-220px"},Es={class:"w-220px"},Ts={class:"w-220px"},js={class:"w-220px"},Ds=T("span",null,"Add content replacement",-1),As=T("li",null," Proxy dir: When accessing this dir, the content of the target URL will be displayed (Advanced Needs) ",-1),Ns=T("li",null," Target URL:Fill in the website you need to proxy, the target URL must be an accessible URL ",-1),Is=T("li",null," Sent Domain: Add the domain name to the request header and pass it to the proxy server ",-1),qs=T("li",null," Content replacement: Nginx exclusive, replace the content of the website with the specified content ",-1),Bs=L({__name:"form",props:{data:{}},setup(a,{expose:t}){const l=a,{isEdit:i,siteName:n,row:o,getList:r}=l.data,c=R(null),p=N({type:1,proxyname:"",cachetime:1,proxydir:"/",proxysite:"http://",todomain:"$host",cache:0,advanced:0,sitename:n}),m={proxyname:{trigger:["blur","input"],validator:()=>""!==p.proxyname.trim()||new Error("Please input proxy name")},cachetime:{trigger:["blur","input"],validator:()=>!(1===p.cache&&!p.cachetime)||new Error("Please input cache time")},proxydir:{trigger:["blur","input"],validator:()=>1!==p.advanced||""!==p.proxydir.trim()||new Error("Please input proxy dir")},proxysite:{trigger:["blur","input"],validator:()=>""!==p.proxysite.trim()||new Error("Please input target url")},todomain:{trigger:["blur","input"],validator:()=>""!==p.todomain.trim()||new Error("Please input sent Domain")}},v=e=>{e=(e=e.replace(/^http[s]?:\/\//,"")).replace(/(:|\?|\/|\\)(.*)$/,""),/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/.test(e)?p.todomain="$host":p.todomain=e},y=R([]),f=()=>{y.value.length>=3||y.value.push({sub1:"",sub2:""})};f();return(()=>{if(i&&o){p.type=o.type,p.cache=o.cache,p.advanced=o.advanced,p.proxyname=o.proxyname,p.cachetime=o.cachetime,p.proxydir=o.proxydir,p.proxysite=o.proxysite,p.todomain=o.todomain,p.sitename=o.sitename;const e=o.subfilter.filter((e=>""!==e.sub1||""!==e.sub2));e.length>0&&(y.value=e)}})(),t({onConfirm:async({hide:e})=>{var a;await(null==(a=c.value)?void 0:a.validate());const t=(()=>{const e=[{sub1:"",sub2:""},{sub1:"",sub2:""},{sub1:"",sub2:""}];return e.forEach(((e,a)=>{y.value.length-1<a||(e.sub1=y.value[a].sub1,e.sub2=y.value[a].sub2)})),{...M(p),subfilter:e}})();i?await Ze(t):await Ye(t),null==r||r(),e()}}),(a,t)=>{const l=pa,n=va,o=u,r=d,w=h,_=ja,g=Da,b=e,x=s,k=ya,P=_a;return S(),E("div",Us,[U(k,{ref_key:"formRef",ref:c,model:D(p),rules:m},{default:j((()=>[U(o,{size:32},{default:j((()=>[U(n,{label:"Enable proxy"},{default:j((()=>[U(l,{value:D(p).type,"onUpdate:value":t[0]||(t[0]=e=>D(p).type=e),"checked-value":1,"unchecked-value":0},null,8,["value"])])),_:1}),U(n,{label:"Enable cache","label-width":"100"},{default:j((()=>[U(l,{value:D(p).cache,"onUpdate:value":t[1]||(t[1]=e=>D(p).cache=e),"checked-value":1,"unchecked-value":0},null,8,["value"])])),_:1}),U(n,{label:"Advanced feature","label-width":"126"},{default:j((()=>[U(l,{value:D(p).advanced,"onUpdate:value":t[2]||(t[2]=e=>D(p).advanced=e),"checked-value":1,"unchecked-value":0},null,8,["value"])])),_:1})])),_:1}),U(n,{label:"Proxy name"},{default:j((()=>[T("div",Cs,[U(r,{value:D(p).proxyname,"onUpdate:value":t[3]||(t[3]=e=>D(p).proxyname=e),disabled:D(i),placeholder:""},null,8,["value","disabled"])])])),_:1}),1===D(p).cache?(S(),H(n,{key:0,label:"Cache time",path:"cachetime"},{default:j((()=>[T("div",Ls,[U(g,null,{default:j((()=>[U(w,{value:D(p).cachetime,"onUpdate:value":t[4]||(t[4]=e=>D(p).cachetime=e),min:1,"show-button":!1,placeholder:""},null,8,["value"]),U(_,{class:"w-70px text-center"},{default:j((()=>[C(z(D(p).cachetime>1?"Minutes":"Minute"),1)])),_:1})])),_:1})])])),_:1})):B("",!0),1===D(p).advanced?(S(),H(n,{key:1,label:"Proxy dir",path:"proxydir"},{default:j((()=>[T("div",Rs,[U(r,{value:D(p).proxydir,"onUpdate:value":t[5]||(t[5]=e=>D(p).proxydir=e),placeholder:""},null,8,["value"])])])),_:1})):B("",!0),U(n,{label:"Target URL"},{default:j((()=>[T("div",Ss,[U(r,{value:D(p).proxysite,"onUpdate:value":[t[6]||(t[6]=e=>D(p).proxysite=e),v],placeholder:""},null,8,["value"])])])),_:1}),U(n,{label:"Sent Domain"},{default:j((()=>[T("div",Es,[U(r,{value:D(p).todomain,"onUpdate:value":t[7]||(t[7]=e=>D(p).todomain=e),placeholder:""},null,8,["value"])])])),_:1}),U(n,{label:"Content replace"},{default:j((()=>[U(o,{class:"flex-1",vertical:""},{default:j((()=>[(S(!0),E(q,null,F(D(y),((e,a)=>(S(),H(o,{key:"".concat(a+1),class:"items-center"},{default:j((()=>[T("div",Ts,[U(r,{value:e.sub1,"onUpdate:value":a=>e.sub1=a,placeholder:"Source Text"},null,8,["value","onUpdate:value"])]),T("div",js,[U(r,{value:e.sub2,"onUpdate:value":a=>e.sub2=a,placeholder:"Replace to, can be blank"},null,8,["value","onUpdate:value"])]),T("div",null,[U(b,{type:"error",disabled:0===a&&1===D(y).length,onClick:e=>(e=>{y.value.length<=1||y.value.splice(e,1)})(a)},{default:j((()=>[C(" Del ")])),_:2},1032,["disabled","onClick"])])])),_:2},1024)))),128)),T("div",null,[U(x,{type:"primary",disabled:D(y).length>=3,onClick:f},{default:j((()=>[Ds])),_:1},8,["disabled"])])])),_:1})])),_:1})])),_:1},8,["model"]),U(P,{class:"mt-12px"},{default:j((()=>[As,Ns,Is,qs])),_:1})])}}}),Ms={class:"p-20px"},Hs={class:"mt-12px"},Ks=T("li",null," This is the configuration file of the load balancing. Not modify if you do not understand the configuration rules. ",-1),Os=L({__name:"config",props:{data:{}},emits:["close"],setup(e,{emit:a}){const l=e,{row:i,siteName:n,getList:r}=l.data,d=a,u=y(),c=R(""),p=R(""),m=R(""),h=async()=>{const{message:e}=await ea({path:m.value,data:c.value,encoding:p.value});o(e)&&t.success(e.msg),null==r||r(),d("close")};return(async()=>{const{message:e}=await Je({sitename:n,proxyname:i.proxyname,webserver:u.webserver});o(e)&&(m.value=e.file,c.value=e.data,p.value=e.encoding)})(),(e,a)=>{const t=s,l=_a;return S(),E("div",Ms,[U(xa,{value:D(c),"onUpdate:value":a[0]||(a[0]=e=>A(c)?c.value=e:null),height:350,"show-tips":!1},null,8,["value"]),T("div",Hs,[U(t,{type:"primary",onClick:h},{default:j((()=>[C("Save")])),_:1})]),U(l,{class:"mt-24px"},{default:j((()=>[Ks])),_:1})])}}}),zs=L({__name:"index",setup(t,{expose:n}){const{data:o}=Ba(),r=e=>({proxyname:e.proxyname,sitename:e.sitename,proxydir:e.proxydir,proxysite:e.proxysite,todomain:e.todomain,subfilter:e.subfilter,advanced:e.advanced,cachetime:e.cachetime}),{keys:d,table:u,columns:p}=Y([{type:"selection",width:40},{key:"proxyname",title:"Name",width:80,ellipsis:{tooltip:{width:"trigger"}}},{key:"proxydir",title:"Proxy dir",width:90,ellipsis:{tooltip:{width:"trigger"}}},{key:"proxysite",title:"Target URL",ellipsis:{tooltip:{width:"trigger"}},render:e=>U("a",{class:"text-primary text-primary-hover",href:e.proxysite,target:"_blank"},[e.proxysite])},{key:"cache",title:"Cache",width:90,render:a=>U(e,{type:1===a.cache?"primary":"error",onClick:async()=>{await Ze({...r(a),type:a.type,cache:1===a.cache?0:1}),a.cache=1===a.cache?0:1}},{default:()=>[1===a.cache?"Enabled":"Disabled"]})},{key:"type",title:"Status",width:90,render:e=>U(ma,{value:e.type,"checked-value":1,"unchecked-value":0,"checked-title":"Running","unchecked-title":"Paused",onClick:async a=>{await Ze({...r(e),type:a,cache:e.cache}),e.type=a}},null)},ca({width:120,options:e=>[{label:"Conf",onClick:()=>{b(e)}},{label:"Edit",onClick:()=>{_(e)}},{label:"Del",onClick:()=>{a({title:"Delete reverse proxy [".concat(e.proxyname,"]"),content:"Are you sure to delete from list?",onConfirm:async({hide:a})=>{await aa({sitename:o.name,proxyname:e.proxyname}),y(),a()}})}}]})]),m=[{key:"del",type:"confirm",label:"Please choose del",confirm:{title:"Batch delete",desc:"Please be cautious, The selected item will be [delete] after confirmation",api:e=>aa({sitename:o.name,proxyname:e.proxyname},!1),done:()=>{y()},columns:[{key:"proxyname",title:"Name",ellipsis:{tooltip:{width:"trigger"}}}]}}],{loading:h,setLoading:v}=da(),y=async()=>{try{v(!0);const{message:e}=await ta({sitename:o.name});u.data=l(e)?e:[]}finally{d.value=[],v(!1)}},f=i("Create reverse proxy",{row:void 0,siteName:o.name,isEdit:!1,getList:y}),w=()=>{f.data.row=void 0,f.data.isEdit=!1,f.title="Create reverse proxy",f.show=!0},_=e=>{f.data.row=e,f.data.isEdit=!0,f.title="Modify redirection [".concat(e.proxyname,"]"),f.show=!0},g=i("",{row:void 0,siteName:o.name,getList:y}),b=e=>{g.data.row=e,g.title="Edit profile [".concat(e.proxyname,"]"),g.show=!0};return y(),n({init:y}),(e,a)=>{const t=s,l=Z,i=Q,n=G,o=c;return S(),E("div",null,[U(n,null,{toolsLeft:j((()=>[U(t,{type:"primary",onClick:w},{default:j((()=>[C("Add reverse proxy")])),_:1})])),table:j((()=>[U(l,{"checked-row-keys":D(d),"onUpdate:checkedRowKeys":a[0]||(a[0]=e=>A(d)?d.value=e:null),"row-key":"proxyname",loading:D(h),"max-height":440,data:D(u).data,columns:D(p)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:j((()=>[U(i,{"checked-row-keys":D(d),"onUpdate:checkedRowKeys":a[1]||(a[1]=e=>A(d)?d.value=e:null),"row-key":"proxyname",data:D(u).data,options:m},null,8,["checked-row-keys","data"])])),_:1}),U(o,{show:D(f).show,"onUpdate:show":a[2]||(a[2]=e=>D(f).show=e),title:D(f).title,data:D(f).data,width:660,footer:!0,component:Bs},null,8,["show","title","data"]),U(o,{show:D(g).show,"onUpdate:show":a[3]||(a[3]=e=>D(g).show=e),title:D(g).title,data:D(g).data,width:580,component:Os},null,8,["show","title","data"])])}}}),Ws={class:"pt-8px"},Vs=L({__name:"index",setup(e,{expose:a}){const{data:t}=Ba(),l=R();return a({init:()=>{l.value.init()}}),(e,a)=>(S(),E("div",Ws,[U(La,{ref_key:"formRef",ref:l,site:D(t)},null,8,["site"])]))}}),Fs=L({__name:"index",setup(e,{expose:a}){const{data:t}=Ba(),l=R("None"),{loading:s,setLoading:i}=da(),n=async()=>{try{i(!0);const{message:e}=await la({siteName:t.name});o(e)&&(l.value=v(e.result)?e.result:"None")}finally{i(!1)}};return n(),a({init:n}),(e,a)=>{const t=Aa,i=Na;return S(),H(i,{class:"h-560px",show:D(s)},{default:j((()=>[U(t,{log:D(l)},null,8,["log"])])),_:1},8,["show"])}}}),Xs=L({__name:"index",setup(e,{expose:a}){const{data:t}=Ba(),l=R("None"),{loading:s,setLoading:i}=da(),n=async()=>{try{i(!0);const{message:e}=await sa({siteName:t.name});o(e)&&(l.value=v(e.result)?e.result:"None")}finally{i(!1)}};return n(),a({init:n}),(e,a)=>{const t=Aa,i=Na;return S(),H(i,{class:"h-560px",show:D(s)},{default:j((()=>[U(t,{log:D(l)},null,8,["log"])])),_:1},8,["show"])}}}),$s=L({__name:"logs",props:{data:{}},setup(e){const a=e,{type:t,path:l}=a.data,s=R(""),{loading:i,setLoading:n}=da();return(async()=>{try{n(!0);const{message:e}=await ia({type:t,path:l});o(e)&&(s.value=e.result)}finally{n(!1)}})(),(e,a)=>{const t=Aa,l=Na;return S(),H(l,{class:"w-650px h-550px bg-#282C34",show:D(i)},{default:j((()=>[U(t,{log:D(s)},null,8,["log"])])),_:1},8,["show"])}}}),Gs=T("li",null,[C(" Log analysis: Scan the logs(/www/wwwroot/.log) for requests with attack (types include: "),T("span",{class:"text-error"},"xss,sql,san,php"),C(") ")],-1),Qs=T("li",null,"Analyzed log data contains intercepted requests",-1),Ys=T("li",null,"By default, the last scan data is displayed (if not, please click log scan)",-1),Zs=T("li",null,"If the log file is too large, scanning may take a long time, please be patient",-1),Js={class:"w-400px p-20px"},ei=T("div",{class:"mb-16px"},"Scanning, scanning progress...",-1),ai=L({__name:"index",setup(l,{expose:i}){const n=y(),{data:r}=Ba(),d=X((()=>{let e="";switch(n.webserver){case"nginx":e=".log";break;case"apache":e="-access_log";break;default:e="_ols.access_log"}return"/www/wwwlogs/".concat(r.name).concat(e)})),u=X((()=>{const e=d.value.split("/");return e[e.length-1]})),p=()=>{a({title:"Scan website logs",content:"It is recommended to perform security analysis when the server load is low. This time, the [".concat(u.value,"] file will be scanned. It may take a long time. Do you want to continue?"),onConfirm:async({hide:e})=>{await na({path:d.value}),e(),v()}})},m=R(!1),h=R(0),v=async()=>{m.value=!0,f()},f=(e=0)=>{let a=setTimeout((async()=>{const{message:e}=await oa({path:d.value});o(e)&&(h.value=e.result,h.value>=100?(t.success("Scan complete"),m.value=!1,h.value=0,P(),clearTimeout(a)):f(1e3))}),e)},w=e=>{g({title:"[".concat(e,"] log details"),data:{type:e,path:d.value},component:$s})},{table:_,columns:b}=Y([{key:"start_time",title:"Date"},{key:"time",title:"Time",render:e=>"".concat(e.time.substring(0,4)," s")},{key:"xss",title:"XSS",render:e=>e.xss>0?U("span",{class:"text-error"},[e.xss]):e.xss},{key:"sql",title:"SQL",render:e=>e.sql>0?U("span",{class:"text-error"},[e.sql]):e.sql},{key:"san",title:"Sacn",render:e=>e.san>0?U("span",{class:"text-error"},[e.san]):e.san},{key:"php",title:"PHP",render:e=>e.php>0?U("span",{class:"text-error"},[e.php]):e.php},{key:"ip",title:"IP (top100)",render:a=>a.ip>0?U(e,{onClick:()=>{w("ip")}},{default:()=>[a.ip]}):a.ip},{key:"url",title:"URL (top100)",render:a=>a.url>0?U(e,{onClick:()=>{w("url")}},{default:()=>[a.url]}):a.url}]),{loading:x,setLoading:k}=da(),P=async()=>{try{k(!0);const{message:e}=await ra({path:d.value});o(e)&&(_.data=[e])}finally{k(!1)}},L=()=>{P()};return L(),i({init:L}),(a,t)=>{const l=s,i=Z,n=G,o=_a,r=Ia,d=c;return S(),E("div",null,[U(n,null,{toolsLeft:j((()=>[U(l,{type:"primary",onClick:p},{default:j((()=>[C("Log scan")])),_:1})])),table:j((()=>[U(i,{loading:D(x),"loading-num":1,data:D(_).data,columns:D(b)},null,8,["loading","data","columns"])])),_:1}),U(o,{class:"mt-16px"},{default:j((()=>[Gs,Qs,Ys,Zs,T("li",null,[U(e,{href:"https://forum.aapanel.com/d/3351-nginx-waf-instructions",target:"_blank"},{default:j((()=>[C(" aaPanel WAF ")])),_:1}),C(" can effectively block such attacks ")])])),_:1}),U(d,{show:D(m),"onUpdate:show":t[0]||(t[0]=e=>A(m)?m.value=e:null)},{default:j((()=>[T("div",Js,[ei,U(r,{type:"line",status:"success",height:24,percentage:D(h),"border-radius":4,"indicator-placement":"inside"},null,8,["percentage"])])])),_:1},8,["show"])])}}}),ti=L({__name:"index",setup(e,{expose:a}){const{config:t}=Ba(),l=R("access"),s=R(),i=[{key:"access",label:"Access log",component:Fs},{key:"error",label:"Error log",component:Xs},{key:"security",label:"Log Security Analysis",component:ai}];return l.value=t.subMenu||"access",t.subMenu="",a({init:()=>{l.value="access",$((()=>{var e;null==(e=s.value)||e.init()}))}}),(e,a)=>{const t=wa;return S(),H(t,{value:D(l),"onUpdate:value":a[0]||(a[0]=e=>A(l)?l.value=e:null),ref_key:"tabsRef",ref:s,data:i},null,8,["value"])}}}),li={class:"h-full"},si=L({__name:"index",props:{siteInfo:{},config:{}},setup(e){const a=y(),{siteName:t}=x(a),l=I((()=>n((()=>import("./index124.js?v=1720690738171")),__vite__mapDeps([16,2,3,4,5,17,1,18,7,8,6,9,10,11,12,13,14,15,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49])))),s=I((()=>n((()=>import("./old4.js?v=1720690738171")),__vite__mapDeps([50,51,2,3,4,5,19,20,21,22,23,24,25,26,27,28,29,9,10,11,30,31,32,33,34,35,18,8,17,36,37,38,39,40,41,1,7,6,12,42,43,44,45,46,47,48,49])))),i=e,{siteInfo:o,config:r}=i;t.value=i.siteInfo.name;const d=R();o&&k(qa,{data:o,config:r});const u=R("domain"),c=[{key:"domain",label:"Domain Manager",component:Fa},{key:"subdirectory",label:"Subdirectory binding",component:Ya},{key:"directory",label:"Site directory",component:mt},{key:"access",label:"Limit access",component:Ht},{key:"traffic",label:"Traffic control",component:Zt},{key:"rewrite",label:"URL rewrite",component:l},{key:"document",label:"Default indexes",component:tl},{key:"config",label:"Config",component:nl},{key:"ssl",label:"SSL",component:s},{key:"php",label:"PHP version",component:zl},{key:"wordpress",label:"Wordpress Setting",show:"WP"===(null==o?void 0:o.project_type),component:$l},{key:"composer",label:"Composer",component:ns},{key:"redirect",label:"Redirect",component:Ps},{key:"proxy",label:"Reverse proxy",component:zs},{key:"hotlink",label:"Hotlink Protection",component:Vs},{key:"logs",label:"Response log",component:ti}];return u.value=r.menu||"domain",r.menu="",(e,a)=>{const t=b;return S(),E("div",li,[U(t,{value:D(u),"onUpdate:value":a[0]||(a[0]=e=>A(u)?u.value=e:null),ref_key:"tabsRef",ref:d,data:c},null,8,["value"])])}}}),ii=Object.freeze(Object.defineProperty({__proto__:null,default:si},Symbol.toStringTag,{value:"Module"}));export{ii as i,Ba as u};
