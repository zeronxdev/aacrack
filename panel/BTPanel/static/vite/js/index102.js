import{J as e,j as t,_ as a,b3 as s,a as l,cv as i,G as n,cC as o,H as r}from"./index.js?v=1720690738171";import{b4 as d,b5 as p}from"./site2.js?v=1720690738171";import{a as u,_ as c}from"./index.vue_vue_type_script_setup_true_lang12.js?v=1720690738171";import{b as m}from"./file2.js?v=1720690738171";import{l as f,r as v,k as h,S as x,Z as b,_ as g,P as _,F as y,ag as w,V as k,q as j,a3 as C,W as T,af as D,aj as M,a5 as z,a6 as R,b as S,$ as E,ay as P}from"./vue.js?v=1720690738171";import{_ as N}from"./Ellipsis.js?v=1720690738171";import{u as I}from"./use-theme-vars.js?v=1720690738171";import{_ as B,a as U}from"./Checkbox.js?v=1720690738171";import"./pinia.js?v=1720690738171";import"./Progress.js?v=1720690738171";import"./DataTable.js?v=1720690738171";import"./Select.js?v=1720690738171";import"./Tag.js?v=1720690738171";import"./Empty.js?v=1720690738171";import"./omit.js?v=1720690738171";const V=e=>(z("data-v-cdf052c1"),e=e(),R(),e),A={class:"p-24px"},F={class:"flex"},q=V((()=>g("div",{class:"flex-1 ml-14px pt-6px"},[g("div",{class:"text-19px font-bold text-#111"}," Please calm down for a few seconds and confirm the following data to be deleted. ")],-1))),G={class:"site-content mt-24px"},H={class:"site-size"},J={class:"site-title"},O={class:"site-path"},W=V((()=>g("div",null,"Path:",-1))),Z={class:"value"},$=V((()=>g("span",null,"(",-1))),K=V((()=>g("span",{class:"font-bold text-error"},"More than 50 MB ",-1))),L=V((()=>g("span",{class:"glyphicon glyphicon-info-sign text-error"},null,-1))),Q={key:1},X=V((()=>g("span",null,")",-1))),Y={key:0},ee={class:"site-time"},te=V((()=>g("span",null,"Create: ",-1))),ae=V((()=>g("p",null," Note: This site is created earlier and may contain important data. Exercise caution when performing this operation. ",-1))),se={key:0,class:"site-db"},le={class:"db-name"},ie={class:"db-size"},ne=V((()=>g("p",null," Note: This database is large and may contain important data. Exercise caution when performing this operation. ",-1))),oe={class:"db-time"},re=V((()=>g("span",null,"Create: ",-1))),de=V((()=>g("p",null," Note: This site is created earlier and may contain important data. Exercise caution when performing this operation. ",-1))),pe={class:"mt-24px text-13px text-error"},ue={key:0},ce=[V((()=>g("span",{class:"glyphicon glyphicon-info-sign"},null,-1))),V((()=>g("span",null," Risks: The database recycle bin function is not enabled at present. After the database is deleted, the database will disappear forever! ",-1)))],me={key:1,class:"mt-6px"},fe=[V((()=>g("span",{class:"glyphicon glyphicon-info-sign"},null,-1))),V((()=>g("span",null," Risk: The file recycle bin function is disabled at present. After a site directory is deleted, the site directory will disappear forever! ",-1)))],ve={key:2,class:"mt-6px text-#333"},he=V((()=>g("span",null," Please read the above information to be deleted carefully to prevent site data from being deleted by mistake. Confirm that there are still ",-1))),xe={class:"text-error font-bold"},be=V((()=>g("span",null," seconds left to delete.",-1))),ge={key:3,class:"mt-6px"},_e=l(f({__name:"verify",props:{data:{}},emits:["setConfirm"],setup(l,{expose:i,emit:n}){const o=l,r=n,{rows:p,type:u,delSite:c}=o.data,f=v(!0),z=v(!0),R=h((()=>!!u.find((e=>"database"===e)))),S=h((()=>!!u.find((e=>"path"===e)))),E=v([]),P=v(5);return(()=>{r("setConfirm",{type:"error",disabled:!0,text:"Confirm deletion (continue operation after ".concat(P.value," seconds)")});const e=setInterval((()=>{P.value--,r("setConfirm",{text:"Confirm deletion (continue operation after ".concat(P.value," seconds)")}),0===P.value&&(clearInterval(e),r("setConfirm",{disabled:!1,text:"Confirm deletion"}))}),1e3)})(),(async()=>{const{message:e}=await d({ids:p.map((e=>e.id))});t(e)&&(E.value=e.data.map((e=>{const{database:a}=e;return t(a)&&(a.addtime_show=a.addtime.split(" ")[0],a.is_time_rule=Math.round(Date.now()/1e3)-a.st_time>2592e3&&a.total>10240),{...e,addtime_show:e.addtime.split(" ")[0],is_time_rule:Math.round(Date.now()/1e3)-e.st_time>2592e3&&e.total>10240}})))})(),(async()=>{const{message:e}=await m();t(e)&&(f.value=e.status,z.value=e.status_db)})(),i({onConfirm:async({hide:e})=>{await(null==c?void 0:c(e))}}),(l,i)=>{const n=a,o=N,r=s;return x(),b("div",A,[g("div",F,[_(n,{name:"base-warning",size:"34",color:"#f0a020"}),q]),g("div",G,[(x(!0),b(y,null,w(T(E),(a=>(x(),b("div",{key:a.name,class:"content-item"},[g("div",H,[g("div",J,[_(o,null,{default:k((()=>[j("Site: "+C(a.name),1)])),_:2},1024)]),_(r,{trigger:"hover"},{trigger:k((()=>[g("div",O,[W,g("div",Z,C(a.path),1),g("div",null,[$,a.limit?(x(),b(y,{key:0},[K,L],64)):(x(),b("span",Q,C(T(e)(a.total)),1)),X])])])),default:k((()=>[g("div",null,[a.limit?(x(),b("p",Y," Note: This directory may contain important data. Exercise caution when performing this operation. ")):D("",!0),g("p",null,[g("span",null,"Directory: "+C(a.path),1),g("span",null," ("+C((a.limit?"greater than ":"")+T(e)(a.total))+")",1)])])])),_:2},1024),g("div",ee,[_(r,{trigger:"hover",disabled:!a.is_time_rule},{trigger:k((()=>[g("div",null,[te,g("span",{class:M({"text-error":a.is_time_rule})},C(a.addtime_show),3)])])),default:k((()=>[g("div",null,[ae,g("p",null,"Time: "+C(a.addtime_show),1)])])),_:2},1032,["disabled"])])]),T(R)&&T(t)(a.database)?(x(),b("div",se,[g("div",le,[_(o,null,{default:k((()=>[j("DB: "+C(a.name),1)])),_:2},1024)]),g("div",ie,[_(r,{trigger:"hover"},{trigger:k((()=>[j("Size: "+C(T(e)(a.database.total)),1)])),default:k((()=>[g("div",null,[ne,g("p",null,"Database: "+C(T(e)(a.database.total)),1)])])),_:2},1024)]),g("div",oe,[_(r,{trigger:"hover",disabled:!a.database.is_time_rule},{trigger:k((()=>[g("div",null,[re,g("span",{class:M({"text-error":a.database.is_time_rule})},C(a.addtime_show),3)])])),default:k((()=>[g("div",null,[de,g("p",null,"Time: "+C(a.database.addtime_show),1)])])),_:2},1032,["disabled"])])])):D("",!0)])))),128))]),g("div",pe,[T(R)&&!T(z)?(x(),b("div",ue,ce)):D("",!0),T(S)&&!T(f)?(x(),b("div",me,fe)):D("",!0),T(P)>0?(x(),b("div",ve,[he,g("span",xe,C(T(P)),1),be])):(x(),b("div",ge," Note: please read the above information carefully to prevent site data from being deleted by mistake "))])])}}}),[["__scopeId","data-v-cdf052c1"]]),ye={class:"p-24px"},we={class:"flex pl-12px"},ke={class:"flex-1 ml-14px pt-8px"},je=g("div",{class:"text-16px font-bold text-#111"},[g("div",null,"This will delete the selected website profile."),g("div",{class:"mt-20px"}," If the check box below is checked, the corresponding content will be deleted ")],-1),Ce=g("span",{class:"mr-8px"},"Database",-1),Te=g("span",{class:"glyphicon glyphicon-info-sign text-error"},null,-1),De={class:"flex items-center h-40px mt-24px mx-12px pl-48px bg-#f0f0f0 text-14px"},Me=g("span",null,"Result:",-1),ze={class:"mx-12px"},Re=g("span",null,"=",-1),Se={class:"w-80px ml-12px"},Ee=f({__name:"index",props:{data:{}},setup(e,{expose:t}){const l=e,{rows:d}=l.data,m=I(),f=i(),y=v(null),w=v([]),D=h((()=>1===w.value.length&&"ftp"===w.value[0])),M=v(0),z=v(0),R=v(null),N=v(!1),V=v("");let A=null;const F=e=>{P((()=>{(e=>{var t;V.value=e,N.value=!0,null==(t=y.value)||t.focus(),A&&clearTimeout(A),A=window.setTimeout((()=>{N.value=!1}),3e3)})(e)}))()},q=async e=>{1===d.length?(await G(d[0],!0),f.setRefresh(!0),null==e||e()):H(e)},G=async(e,t=!1)=>{const a=w.value.reduce(((e,t)=>(e[t]=1,e)),{});return await p(Object.assign({id:e.id,webname:e.name},a),t)},H=e=>{r({title:"Delete site",hideClose:!0,component:u,data:{title:"Delete site",api:G,data:d,callback:t=>{e(),J(t)}}})},J=e=>{f.setRefresh(!0),r({title:"Batch delete site results",width:440,footer:!0,component:c,data:{title:"Delete site",data:e,status:"done",columns:[{key:"name",title:"Site name",ellipsis:{tooltip:{width:"trigger"}}}]}})};return R.value=null,M.value=Math.round(9*Math.random()+1),z.value=Math.round(9*Math.random()+1),t({onConfirm:async({hide:e})=>null==R.value||null==R.value?(F("The result cannot be null"),!1):R.value!==M.value+z.value?(F("The calculation is incorrect"),!1):void(0===w.value.length||D.value?await q(e):(r({title:1===d.length?"Verify information twice, delete site [".concat(d[0].name,"]"):"Verify the information twice and delete sites in batches",width:740,footer:!0,data:{rows:d,type:w.value,delSite:q},component:_e}),e()))}),(e,t)=>{const l=a,i=B,r=n,d=U,p=o,u=s;return x(),b("div",ye,[g("div",we,[_(l,{name:"base-warning",size:"34",color:"#f0a020"}),g("div",ke,[je,_(d,{value:T(w),"onUpdate:value":t[0]||(t[0]=e=>S(w)?w.value=e:null)},{default:k((()=>[_(r,{size:32,class:"items-center h-24px mt-24px"},{default:k((()=>[_(i,{value:"ftp"},{default:k((()=>[j("FTP")])),_:1}),_(i,{value:"database"},{default:k((()=>[Ce,Te])),_:1}),_(i,{value:"path"},{default:k((()=>[j("Document Root")])),_:1})])),_:1})])),_:1},8,["value"])])]),g("div",De,[Me,g("span",ze,C(T(M))+" + "+C(T(z)),1),Re,g("div",Se,[_(u,{show:T(N),"onUpdate:show":t[2]||(t[2]=e=>S(N)?N.value=e:null),trigger:"manual",placement:"top-start","arrow-point-to-center":!0,style:E({"--n-color":T(m).errorColor,"--n-text-color":"#fff"})},{trigger:k((()=>[_(p,{ref_key:"inputRef",ref:y,value:T(R),"onUpdate:value":t[1]||(t[1]=e=>S(R)?R.value=e:null),size:"small","show-button":!1,placeholder:""},null,8,["value"])])),default:k((()=>[g("div",null,C(T(V)),1)])),_:1},8,["show","style"])])])])}}});export{Ee as default};
