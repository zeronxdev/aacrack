import{_ as e}from"./index.vue_vue_type_script_setup_true_lang.js?v=1720690738171";import{a}from"./index.vue_vue_type_script_setup_true_lang2.js?v=1720690738171";import{u as t,_ as i}from"./useTableData.js?v=1720690738171";import{u as s,J as o,h as l,dm as n,dn as p,dp as r,dq as m,j as d,k as u,m as c,t as f,B as g}from"./index.js?v=1720690738171";import{u as _}from"./useLoading.js?v=1720690738171";import{b as j}from"./useTableColumns.js?v=1720690738171";import{l as y,f as b,t as k,S as h,Z as w,P as C,V as v,q as x,W as D}from"./vue.js?v=1720690738171";import"./DataTable.js?v=1720690738171";import"./Checkbox.js?v=1720690738171";import"./Ellipsis.js?v=1720690738171";import"./Select.js?v=1720690738171";import"./Tag.js?v=1720690738171";import"./Empty.js?v=1720690738171";import"./omit.js?v=1720690738171";import"./Skeleton.js?v=1720690738171";import"./pinia.js?v=1720690738171";import"./Progress.js?v=1720690738171";const z={class:"p-20px"},R=y({__name:"index",props:{data:{}},setup(y){const R=y,{row:S}=R.data,T=s(),B=async()=>{await f(T.type,{id:S.id}),U(),T.setRefresh(!0)},L=b({p:1,limit:10,search:S.id}),{table:q,columns:E}=t([{key:"filename",title:"File name",ellipsis:{tooltip:{width:"trigger"}}},{key:"size",title:"File size",width:90,render:e=>o(e.size)},{key:"addtime",title:"Backup time",width:146},j({width:154,options:e=>[{label:"Repair",onClick:()=>{l({title:"Import Database",content:"Database will be overwritten, continue?",onConfirm:async({hide:a})=>{await n(T.type,{file:e.filename,name:S.name}),T.setRefresh(!0),a()}})}},{label:"Download",onClick:()=>{p(e.filename,e.name)}},{label:"Del",onClick:()=>{l({title:"Delete backup file",content:"Are you sure to delete backup file?",onConfirm:async({hide:a})=>{await r({id:e.id}),U(),T.setRefresh(!0),a()}})}}]})]),{loading:F,setLoading:P}=_(),U=async()=>{try{P(!0);const{message:e}=await m(k(L));d(e)?(q.data=u(e.data)?e.data:[],q.total=c(e.page)):(q.data=[],q.total=0),S.backup_count=q.total}finally{P(!1)}};return U(),(t,s)=>{const o=g,l=i,n=a,p=e;return h(),w("div",z,[C(p,null,{toolsLeft:v((()=>[C(o,{type:"primary",onClick:B},{default:v((()=>[x("Backup")])),_:1})])),table:v((()=>[C(l,{loading:D(F),"loading-num":6,data:D(q).data,columns:D(E)},null,8,["loading","data","columns"])])),pageRight:v((()=>[C(n,{page:D(L).p,"onUpdate:page":s[0]||(s[0]=e=>D(L).p=e),"page-size":D(L).limit,"onUpdate:pageSize":s[1]||(s[1]=e=>D(L).limit=e),"item-count":D(q).total,onRefresh:U},null,8,["page","page-size","item-count"])])),_:1})])}}});export{R as default};
