import{J as e,j as t,_ as a,b3 as l,a as s,cI as i,G as n,cC as o,H as r}from"./index.js?v=1720690738171";import{b4 as d,b5 as u}from"./site2.js?v=1720690738171";import{a as p,_ as c}from"./index.vue_vue_type_script_setup_true_lang12.js?v=1720690738171";import{b as m}from"./file2.js?v=1720690738171";import{l as v,r as S,k as x,S as f,Z as h,_,P as g,a3 as b,F as D,ag as y,V as w,q as C,W as $,af as T,aj as j,a5 as k,a6 as R,ad as z,b as M,$ as I,ay as P}from"./vue.js?v=1720690738171";import{_ as U}from"./Ellipsis.js?v=1720690738171";import{u as E}from"./use-theme-vars.js?v=1720690738171";import{_ as F,a as q}from"./Checkbox.js?v=1720690738171";import"./pinia.js?v=1720690738171";import"./Progress.js?v=1720690738171";import"./DataTable.js?v=1720690738171";import"./Select.js?v=1720690738171";import"./Tag.js?v=1720690738171";import"./Empty.js?v=1720690738171";import"./omit.js?v=1720690738171";const B=e=>(k("data-v-17023237"),e=e(),R(),e),G={class:"p-24px"},H={class:"flex"},J={class:"flex-1 ml-14px pt-6px"},N={class:"text-19px font-bold text-#111"},O={class:"site-content mt-24px"},V={class:"site-size"},W={class:"site-title"},Z={class:"site-path"},A={class:"value"},K=B((()=>_("span",null,"(",-1))),L={class:"font-bold text-error"},Q=B((()=>_("span",{class:"glyphicon glyphicon-info-sign text-error"},null,-1))),X={key:1},Y=B((()=>_("span",null,")",-1))),ee={key:0},te={class:"site-time"},ae={key:0,class:"site-db"},le={class:"db-name"},se={class:"db-size"},ie={class:"db-time"},ne={class:"mt-24px text-13px text-error"},oe={key:0},re=B((()=>_("span",{class:"glyphicon glyphicon-info-sign"},null,-1))),de={key:1,class:"mt-6px"},ue=B((()=>_("span",{class:"glyphicon glyphicon-info-sign"},null,-1))),pe={key:2,class:"mt-6px text-#333"},ce={class:"text-error font-bold"},me={key:3,class:"mt-6px"},ve=s(v({__name:"verify",props:{data:{}},emits:["setConfirm"],setup(s,{expose:i,emit:n}){const o=s,r=n,{rows:u,type:p,delSite:c}=o.data,v=S(!0),k=S(!0),R=x((()=>!!p.find((e=>"database"===e)))),z=x((()=>!!p.find((e=>"path"===e)))),M=S([]),I=S(5);return(()=>{r("setConfirm",{type:"error",disabled:!0,text:"Confirm deletion (continue operation after ".concat(I.value," seconds)")});const e=setInterval((()=>{I.value--,r("setConfirm",{text:"Confirm deletion (continue operation after ".concat(I.value," seconds)")}),0===I.value&&(clearInterval(e),r("setConfirm",{disabled:!1,text:"Confirm deletion"}))}),1e3)})(),(async()=>{const{message:e}=await d({ids:u.map((e=>e.id))});t(e)&&(M.value=e.data.map((e=>{const{database:a}=e;return t(a)&&(a.addtime_show=a.addtime.split(" ")[0],a.is_time_rule=Math.round(Date.now()/1e3)-a.st_time>2592e3&&a.total>10240),{...e,addtime_show:e.addtime.split(" ")[0],is_time_rule:Math.round(Date.now()/1e3)-e.st_time>2592e3&&e.total>10240}})))})(),(async()=>{const{message:e}=await m();t(e)&&(v.value=e.status,k.value=e.status_db)})(),i({onConfirm:async({hide:e})=>{await(null==c?void 0:c(e))}}),(s,i)=>{const n=a,o=U,r=l;return f(),h("div",G,[_("div",H,[g(n,{name:"base-warning",size:"34",color:"#f0a020"}),_("div",J,[_("div",N,b(s.$t("Site.DelSite.ContentText7")),1)])]),_("div",O,[(f(!0),h(D,null,y($(M),(a=>(f(),h("div",{key:a.name,class:"content-item"},[_("div",V,[_("div",W,[g(o,null,{default:w((()=>[C(b(s.$t("Site.DelSite.Site"))+": "+b(a.name),1)])),_:2},1024)]),g(r,{trigger:"hover"},{trigger:w((()=>[_("div",Z,[_("div",null,b(s.$t("Site.DelSite.Path"))+":",1),_("div",A,b(a.path),1),_("div",null,[K,a.limit?(f(),h(D,{key:0},[_("span",L,b(s.$t("Site.DelSite.More50")),1),Q],64)):(f(),h("span",X,b($(e)(a.total)),1)),Y])])])),default:w((()=>[_("div",null,[a.limit?(f(),h("p",ee,b(s.$t("Site.DelSite.ContentText8")),1)):T("",!0),_("p",null,[_("span",null,b(s.$t("Site.DelSite.Directory"))+": "+b(a.path),1),_("span",null," ("+b((a.limit?"greater than ":"")+$(e)(a.total))+")",1)])])])),_:2},1024),_("div",te,[g(r,{trigger:"hover",disabled:!a.is_time_rule},{trigger:w((()=>[_("div",null,[_("span",null,b(s.$t("Site.DelSite.Create"))+": ",1),_("span",{class:j({"text-error":a.is_time_rule})},b(a.addtime_show),3)])])),default:w((()=>[_("div",null,[_("p",null,b(s.$t("Site.DelSite.ContentText9")),1),_("p",null,b(s.$t("Site.DelSite.Time"))+": "+b(a.addtime_show),1)])])),_:2},1032,["disabled"])])]),$(R)&&$(t)(a.database)?(f(),h("div",ae,[_("div",le,[g(o,null,{default:w((()=>[C(b(s.$t("Site.DelSite.DB"))+": "+b(a.name),1)])),_:2},1024)]),_("div",se,[g(r,{trigger:"hover"},{trigger:w((()=>[C(b(s.$t("Site.DelSite.Size"))+": "+b($(e)(a.database.total)),1)])),default:w((()=>[_("div",null,[_("p",null,b(s.$t("Site.DelSite.ContentText10")),1),_("p",null,b(s.$t("Site.DelSite.Database"))+": "+b($(e)(a.database.total)),1)])])),_:2},1024)]),_("div",ie,[g(r,{trigger:"hover",disabled:!a.database.is_time_rule},{trigger:w((()=>[_("div",null,[_("span",null,b(s.$t("Site.DelSite.Create"))+": ",1),_("span",{class:j({"text-error":a.database.is_time_rule})},b(a.addtime_show),3)])])),default:w((()=>[_("div",null,[_("p",null,b(s.$t("Site.DelSite.ContentText11")),1),_("p",null,b(s.$t("Site.DelSite.Time"))+": "+b(a.database.addtime_show),1)])])),_:2},1032,["disabled"])])])):T("",!0)])))),128))]),_("div",ne,[$(R)&&!$(k)?(f(),h("div",oe,[re,_("span",null,b(s.$t("Site.DelSite.ContentText12")),1)])):T("",!0),$(z)&&!$(v)?(f(),h("div",de,[ue,_("span",null,b(s.$t("Site.DelSite.ContentText13")),1)])):T("",!0),$(I)>0?(f(),h("div",pe,[_("span",null,b(s.$t("Site.DelSite.ContentText14")),1),_("span",ce,b($(I)),1),_("span",null,b(s.$t("Site.DelSite.Second")),1)])):(f(),h("div",me,b(s.$t("Site.DelSite.ContentText15")),1))])])}}}),[["__scopeId","data-v-17023237"]]),Se={class:"p-24px"},xe={class:"flex pl-12px"},fe={class:"flex-1 ml-14px pt-8px"},he={class:"text-16px font-bold text-#111"},_e={class:"mt-20px"},ge={class:"mr-8px"},be=_("span",{class:"glyphicon glyphicon-info-sign text-error"},null,-1),De={class:"flex items-center h-40px mt-24px mx-12px pl-48px bg-#f0f0f0 text-14px"},ye={class:"mx-12px"},we=_("span",null,"=",-1),Ce={class:"w-80px ml-12px"},$e=v({__name:"index",props:{data:{}},setup(e,{expose:t}){const{t:s}=z(),d=e,{rows:m}=d.data,v=E(),D=i(),y=S(null),T=S([]),j=x((()=>1===T.value.length&&"ftp"===T.value[0])),k=S(0),R=S(0),U=S(null),B=S(!1),G=S("");let H=null;const J=e=>{P((()=>{(e=>{var t;G.value=e,B.value=!0,null==(t=y.value)||t.focus(),H&&clearTimeout(H),H=window.setTimeout((()=>{B.value=!1}),3e3)})(e)}))()},N=async e=>{1===m.length?(await O(m[0],!0),D.setRefresh(!0),null==e||e()):V(e)},O=async(e,t=!1)=>{const a=T.value.reduce(((e,t)=>(e[t]=1,e)),{});return await u(Object.assign({id:e.id,webname:e.name},a),t)},V=e=>{r({title:s("Site.Cert.DelSite"),hideClose:!0,component:p,data:{title:s("Site.Cert.DelSite"),api:O,data:m,callback:t=>{e(),W(t)}}})},W=e=>{D.setRefresh(!0),r({title:s("Site.DelSite.DelSiteResult"),width:440,footer:!0,component:c,data:{title:s("Site.Cert.DelSite"),data:e,status:"done",columns:[{key:"name",title:s("Site.TableRow.SiteName"),ellipsis:{tooltip:{width:"trigger"}}}]}})};return U.value=null,k.value=Math.round(9*Math.random()+1),R.value=Math.round(9*Math.random()+1),t({onConfirm:async({hide:e})=>null==U.value||null==U.value?(J(s("Site.DelSite.ContentText5")),!1):U.value!==k.value+R.value?(J(s("Site.DelSite.ContentText6")),!1):void(0===T.value.length||j.value?await N(e):(r({title:1===m.length?"".concat(s("Site.DelSite.ContentText3")," [").concat(m[0].name,"]"):"".concat(s("Site.DelSite.ContentText4")),width:740,footer:!0,data:{rows:m,type:T.value,delSite:N},component:ve}),e()))}),(e,t)=>{const s=a,i=F,r=n,d=q,u=o,p=l;return f(),h("div",Se,[_("div",xe,[g(s,{name:"base-warning",size:"34",color:"#f0a020"}),_("div",fe,[_("div",he,[_("div",null,b(e.$t("Site.DelSite.ContentText1")),1),_("div",_e,b(e.$t("Site.DelSite.ContentText2")),1)]),g(d,{value:$(T),"onUpdate:value":t[0]||(t[0]=e=>M(T)?T.value=e:null)},{default:w((()=>[g(r,{size:32,class:"items-center h-24px mt-24px"},{default:w((()=>[g(i,{value:"ftp"},{default:w((()=>[C(b(e.$t("Site.DelSite.FTP")),1)])),_:1}),g(i,{value:"database"},{default:w((()=>[_("span",ge,b(e.$t("Site.DelSite.Database")),1),be])),_:1}),g(i,{value:"path"},{default:w((()=>[C(b(e.$t("Site.TableRow.Root")),1)])),_:1})])),_:1})])),_:1},8,["value"])])]),_("div",De,[_("span",null,b(e.$t("Site.DelSite.Result"))+":",1),_("span",ye,b($(k))+" + "+b($(R)),1),we,_("div",Ce,[g(p,{show:$(B),"onUpdate:show":t[2]||(t[2]=e=>M(B)?B.value=e:null),trigger:"manual",placement:"top-start","arrow-point-to-center":!0,style:I({"--n-color":$(v).errorColor,"--n-text-color":"#fff"})},{trigger:w((()=>[g(u,{ref_key:"inputRef",ref:y,value:$(U),"onUpdate:value":t[1]||(t[1]=e=>M(U)?U.value=e:null),size:"small","show-button":!1,placeholder:""},null,8,["value"])])),default:w((()=>[_("div",null,b($(G)),1)])),_:1},8,["show","style"])])])])}}});export{$e as default};
