import{_ as e}from"./index57.js?v=1720690738171";import{_ as a}from"./index112.js?v=1720690738171";import{_ as l,a as s}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1720690738171";import{l as o,ad as t,f as n,r as c,k as r,S as d,Z as m,P as u,V as i,_ as p,W as _,ap as g,q as v,a3 as x,b as f}from"./vue.js?v=1720690738171";import{I as k,z as b,n as D,T as y,k as I,a9 as j,B as L,e5 as h}from"./index.js?v=1720690738171";import{u as w}from"./useSocket.js?v=1720690738171";import{_ as S}from"./Select.js?v=1720690738171";import{_ as $}from"./InputGroup.js?v=1720690738171";import"./Tabs.js?v=1720690738171";import"./omit.js?v=1720690738171";import"./Spin.js?v=1720690738171";import"./pinia.js?v=1720690738171";import"./data.js?v=1720690738171";import"./Tag.js?v=1720690738171";import"./Empty.js?v=1720690738171";const C={class:"pt-4px"},W={class:"w-440px"},U={class:"w-440px"},E={class:"px-2px py-4px"},R={class:"h-420px"},T=o({__name:"index",setup(e){const{t:o}=t(),f=k(),h=n({name:null,image:""}),T={name:{trigger:"change",validator:()=>null!==h.name||new Error(o("Docker.LocalImage.pull.index_8"))},image:{trigger:["input","blur"],validator:()=>""!==h.image||new Error(o("Docker.LocalImage.pull.index_9"))}},M=c(null),q=c(o("Docker.LocalImage.pull.index_10")),z=c(!1),B=c([]),G=async()=>{var e;await(null==(e=M.value)?void 0:e.validate()),q.value="",K.value=!0,V(),F()},K=c(!1),P=r((()=>K.value)),{createWebSocket:V,sendSocket:Z,closeWebSocket:A}=w({url:"/ws_model",onMessage:(e,a)=>{const{data:l}=a;if(b(l)&&(q.value+=a.data,l.includes("bt_successful")||l.includes("bt_failed"))){K.value=!1;const e={status:l.includes("bt_successful"),msg:l.includes("bt_successful")?o("Docker.Container.create.command_7"):o("Docker.Container.create.command_6")};e.status?(D.success(e.msg),f.setRefresh(!0)):D.error(e.msg),A()}},onDisconnected:()=>{K.value=!1}}),F=()=>{Z({model_index:"btdocker",mod_name:"image",def_name:"pull_from_some_registry",ws_callback:111,name:h.name,image:h.image})};return(async()=>{try{z.value=!0;const{message:e}=await y();I(e)&&e.length>0&&(B.value=e.map((e=>({label:e.name,value:e.name}))),h.name=e[0].name)}finally{z.value=!1}})(),(e,o)=>{const t=S,n=l,c=j,r=L,f=$,k=s,b=a;return d(),m("div",C,[u(k,{ref_key:"formRef",ref:M,model:_(h),rules:T},{default:i((()=>[u(n,{label:e.$t("Docker.LocalImage.pull.index_3"),path:"name"},{default:i((()=>[p("div",W,[u(t,{value:_(h).name,"onUpdate:value":o[0]||(o[0]=e=>_(h).name=e),loading:_(z),disabled:_(P),options:_(B)},null,8,["value","loading","disabled","options"])])])),_:1},8,["label"]),u(n,{label:e.$t("Docker.LocalImage.pull.index_4"),path:"image"},{default:i((()=>[p("div",U,[u(f,null,{default:i((()=>[u(c,{value:_(h).image,"onUpdate:value":o[1]||(o[1]=e=>_(h).image=e),disabled:_(P),placeholder:e.$t("Docker.LocalImage.pull.index_5"),onKeyup:g(G,["enter"])},null,8,["value","disabled","placeholder"]),u(r,{type:"primary",disabled:_(P),onClick:G},{default:i((()=>[v(x(e.$t("Docker.LocalImage.pull.index_6")),1)])),_:1},8,["disabled"])])),_:1})])])),_:1},8,["label"])])),_:1},8,["model"]),p("div",E,x(e.$t("Docker.LocalImage.pull.index_7")),1),p("div",R,[u(b,{log:_(q)},null,8,["log"])])])}}}),M={class:"pt-4px"},q={class:"px-2px py-4px"},z={class:"h-456px"},B=o({__name:"index",setup(e){const{t:l}=t(),s=k(),o=n({cmd:""}),g=c(l("Docker.LocalImage.pull.index_10")),f=c(!1),y=r((()=>f.value)),I=async()=>{if(""!==o.cmd.trim())try{f.value=!0,g.value=l("Docker.Container.create.command_8"),await h({cmd:o.cmd}),S(),U()}catch(e){f.value=!1}else D.error(l("Docker.LocalImage.pull.index_13"))},{createWebSocket:S,sendSocket:C,closeWebSocket:W}=w({url:"/ws_model",onMessage:(e,a)=>{const{data:o}=a;if(b(o)&&(g.value+=a.data,o.includes("bt_successful")||o.includes("bt_failed"))){f.value=!1;const e={status:o.includes("bt_successful"),msg:o.includes("bt_successful")?l("Docker.Container.create.command_7"):l("Docker.Container.create.command_6")};e.status?(D.success(e.msg),s.setRefresh(!0)):D.error(e.msg),W()}}}),U=()=>{C({model_index:"btdocker",mod_name:"image",def_name:"get_cmd_log",ws_callback:111,name:"",image:""})};return(e,l)=>{const s=j,t=L,n=$,c=a;return d(),m("div",M,[u(n,{class:"mb-16px"},{default:i((()=>[u(s,{value:_(o).cmd,"onUpdate:value":l[0]||(l[0]=e=>_(o).cmd=e),disabled:_(y),placeholder:e.$t("Docker.LocalImage.pull.index_11")},null,8,["value","disabled","placeholder"]),u(t,{type:"primary",disabled:_(y),onClick:I},{default:i((()=>[v(x(e.$t("Docker.LocalImage.pull.index_12")),1)])),_:1},8,["disabled"])])),_:1}),p("div",q,x(e.$t("Docker.LocalImage.pull.index_7")),1),p("div",z,[u(c,{log:_(g)},null,8,["log"])])])}}}),G={class:"p-16px"},K=o({__name:"index",setup(a){const{t:l}=t(),s=c("normal"),o=[{key:"normal",label:l("Docker.LocalImage.pull.index_1"),component:T},{key:"command",label:l("Docker.LocalImage.pull.index_2"),component:B}];return(a,l)=>{const t=e;return d(),m("div",G,[u(t,{value:_(s),"onUpdate:value":l[0]||(l[0]=e=>f(s)?s.value=e:null),data:o},null,8,["value"])])}}});export{K as default};
