import{_ as t}from"./index.vue_vue_type_script_setup_true_lang.js?v=1720690738171";import{u as e,_ as i}from"./useTableData.js?v=1720690738171";import{u as a,K as s,J as o,ds as r,dz as l,h as n,dA as m,dB as d,k as p,n as u,dC as c,B as h}from"./index.js?v=1720690738171";import{b as f}from"./useTableColumns.js?v=1720690738171";import{u as w}from"./useLoading.js?v=1720690738171";import{l as k,S as g,Z as j,P as y,V as b,q as _,W as x}from"./vue.js?v=1720690738171";import"./Skeleton.js?v=1720690738171";import"./DataTable.js?v=1720690738171";import"./Checkbox.js?v=1720690738171";import"./Ellipsis.js?v=1720690738171";import"./Select.js?v=1720690738171";import"./Tag.js?v=1720690738171";import"./Empty.js?v=1720690738171";import"./omit.js?v=1720690738171";import"./pinia.js?v=1720690738171";import"./Progress.js?v=1720690738171";const C={class:"p-20px"},v=k({__name:"index",props:{data:{}},setup(k){const v=k,{sid:L}=v.data,D=a(),B=async()=>{if(null===L)throw u.error("Please select remote database!"),new Error("sid is null");await c({sid:L}),P()},{table:z,columns:E}=e([{key:"name",title:"File name",width:180,ellipsis:{tooltip:{width:"trigger"}}},{key:"filepath",title:"File path",ellipsis:{tooltip:{width:"trigger"}}},{key:"mtime",title:"Backup time",width:150,render:t=>s(t.mtime)},{key:"size",title:"File size",width:80,render:t=>o(t.size)},{key:"sid",title:"Backup location",width:120,render:t=>{let e="--";for(let i=0;i<D.remoteList.length;i++)if("".concat(D.remoteList[i].id)===t.sid){e=D.remoteList[i].ps||D.remoteList[i].db_host;break}return e}},f({width:100,options:t=>[{label:"Repair",onClick:()=>{r({text:"Overwrite the data",title:"Overwrite the data",content:"Data will be overwritten using [".concat(t.name,"], Do you want to continue?"),onConfirm:async({hide:e})=>{if(null===L)throw new Error("sid is null");await l({file:t.filepath,sid:L}),D.setRefresh(!0),e()}})}},{label:"Del",onClick:()=>{n({title:"Delete backup",content:"Whether to delete the [".concat(t.name,"] backup"),onConfirm:async({hide:e})=>{await m({file:t.filepath}),P(),e()}})}}]})]),{loading:T,setLoading:F}=w(),P=async()=>{try{F(!0);const{message:t}=await d();z.data=p(t)?t:[]}finally{F(!1)}};return P(),(e,a)=>{const s=h,o=i,r=t;return g(),j("div",C,[y(r,null,{toolsLeft:b((()=>[y(s,{type:"primary",onClick:B},{default:b((()=>[_("Backup")])),_:1})])),table:b((()=>[y(o,{"max-height":400,loading:x(T),columns:x(E),data:x(z).data},null,8,["loading","columns","data"])])),_:1})])}}});export{v as default};
