import{_ as a}from"./index111.js?v=1720690738171";import{_ as e}from"./index53.js?v=1720690738171";import{c$ as t,b1 as s,h as n,d0 as l,n as i,aj as p,d1 as o,j as d,p as u,B as r,a as m,k as c,d2 as v,G as _,d3 as b,d4 as h,d5 as x,d6 as y,d7 as f,cd as w,d8 as g,cC as D,a9 as $}from"./index.js?v=1720690738171";import{h as k,b as j}from"./useAccount.js?v=1720690738171";import{A as C,a as P,l as S,ad as U,r as T,S as B,Z as E,_ as L,P as N,V as q,q as A,a3 as I,W as z,a5 as F,a6 as H,f as M,b as G,F as R,af as V,d as W}from"./vue.js?v=1720690738171";import{_ as Z}from"./Checkbox.js?v=1720690738171";import{u as J}from"./useLoading.js?v=1720690738171";import{ai as K}from"./site2.js?v=1720690738171";import{_ as O}from"./Select.js?v=1720690738171";import{_ as Q,a as X}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1720690738171";import{_ as Y}from"./useTableColumns.js?v=1720690738171";import"./Tabs.js?v=1720690738171";import"./omit.js?v=1720690738171";import"./Ellipsis.js?v=1720690738171";import"./pinia.js?v=1720690738171";import"./Tag.js?v=1720690738171";import"./Empty.js?v=1720690738171";import"./Progress.js?v=1720690738171";const aa=Symbol("php-admin");function ea(a,e,t,s){return new Promise((n=>{const l="".concat(a,"/index.php?lang=en"),i=document.createElement("form"),p='\n\t\t\t<input type="text" name="pma_username" id="pma_username" value="'.concat(t,'" />\n\t\t\t<input type="password" name="pma_password" id="pma_password" value="').concat(s,'" />\n\t\t\t<input type="text" name="server" value="1" />\n\t\t\t<input type="text" name="target" value="index.php" />\n\t\t\t<input type="text" name="db" id="db" value="').concat(e,'" />\n\t\t');i.action=l,i.setAttribute("public-data",l),i.method="post",i.target="_blank",i.style.display="none",i.innerHTML=p,document.body.appendChild(i),i.submit(),document.body.removeChild(i),n(i)}))}async function ta(a,e){const{data:s}=await t.get("/phpmyadmin/index.php?lang=en"),n={session:"",token:""},l=s.match(/"set_session"\s+value="(\w+)"/),i=s.match(/"token"\s+value="(\w+)"/);l&&l.length>1&&(n.session=l[1]||""),i&&i.length>1&&(n.token=i[1]||"");const p=document.createElement("form");p.action="/phpmyadmin/index.php",p.method="post",p.target="_blank",p.style.display="none";const o='\n\t\t<input  name="set_session" id="input_session" value="'.concat(n.session,'" />\n\t\t<input type="text" name="pma_username" id="pma_username" value="').concat(a,'" size="24" />\n\t\t<input type="password" name="pma_password" id="pma_password" value="').concat(e,'" size="24" />\n\t\t<input  name="token" id="input_token" value="').concat(n.token,'" />\n\t\t<input  name="target" id="input_target" value="index.php" />\n\t\t<input  name="server" value="1" id="input_server" />\n\t');p.innerHTML=o,document.body.appendChild(p),p.submit(),document.body.removeChild(p)}const sa={class:"p-4px"},na={class:"mb-16px"},la={class:"text-error"},ia={class:"mt-20px"},pa=(a=>(F("data-v-1a5b087a"),a=a(),H(),a))((()=>L("span",{class:"bg-recommend"},null,-1))),oa="phpmyadmin",da=m(S({__name:"index",setup(a,{expose:t}){const{t:m}=U(),c=s(),{mysqlInfo:v}=P(aa),_=T(!1),b=a=>{n({title:m("Database.phpadmin.index_12",[m(a?"Public.Status.Start":"Public.Status.Stop")]),content:m("Database.phpadmin.index_13",[m(a?"Public.Status.start":"Public.Status.stop")]),onConfirm:async()=>{await l({name:oa,type:a?"start":"stop"}),x()}})},h=async a=>{const e=i.loading(m("Database.phpadmin.index_14"));try{const{message:t}=await k({sName:oa}),s=p(t,"ext.url",""),n=p(t,"ext.auth",!1);if("panel"==a){if(n)return i.error(m("Database.phpadmin.index_15")),void e.close();if(c.isFree)return j({source:160}),void e.close();if(v.value)await ta(v.value.username,v.value.password);else{const{message:a}=await o(),e=p(a,"result","");await ta("root",e)}}else if(v.value)await ea(s,v.value.name,v.value.username,v.value.password);else{const{message:a}=await o(),e=p(a,"result","");await ea(s,"","root",e)}e.close()}catch(t){e.close(),console.error(t)}},x=async()=>{const{message:a}=await k({sName:oa});d(a)&&(_.value=a.status)};return x(),t({init:x}),(a,t)=>{const s=Z,n=e,l=u,i=r;return B(),E("div",sa,[L("div",na,[N(s,{checked:z(_),"onUpdate:checked":b},{default:q((()=>[A(I(a.$t("Database.phpadmin.index_4")),1)])),_:1},8,["checked"])]),N(n,{class:"mb-20px"},{default:q((()=>[L("li",la,I(a.$t("Database.phpadmin.index_5")),1)])),_:1}),N(l,{dashed:""}),L("div",ia,[N(i,{onClick:t[0]||(t[0]=a=>h("panel"))},{default:q((()=>[L("span",null,I(a.$t("Database.phpadmin.index_11")),1),pa])),_:1}),N(i,{class:"ml-24px",onClick:t[1]||(t[1]=a=>h())},{default:q((()=>[A(I(a.$t("Database.phpadmin.index_6")),1)])),_:1})]),N(n,{class:"mt-16px"},{default:q((()=>[L("li",null,I(a.$t("Database.phpadmin.index_7")),1),L("li",null,I(a.$t("Database.phpadmin.index_8")),1),L("li",null,I(a.$t("Database.phpadmin.index_9")),1),L("li",null,I(a.$t("Database.phpadmin.index_10")),1)])),_:1})])}}}),[["__scopeId","data-v-1a5b087a"]]),ua={class:"w-160px"},ra=S({__name:"index",setup(a,{expose:e}){const{t:t}=U(),s=M({php_version:null}),n=T([]),{loading:l,setLoading:o}=J(),d=async()=>{try{o(!0);const[a,e]=await Promise.all([K(),k({sName:"phpmyadmin"})]),{message:t}=a;c(t)&&(n.value=t.map((a=>({label:a.name,value:a.version}))));const{message:l}=e;s.php_version=p(l,"ext.phpversion",null)}finally{o(!1)}},u=async()=>{const a=s.php_version;null!==a?(await v({phpversion:a}),d()):i.error(t("Database.phpadmin.index_32"))};return d(),e({init:d}),(a,e)=>{const t=O,i=r,p=_;return B(),E("div",null,[N(p,{class:"items-center"},{default:q((()=>[L("span",null,I(a.$t("Database.phpadmin.index_31")),1),L("div",ua,[N(t,{value:z(s).php_version,"onUpdate:value":e[0]||(e[0]=a=>z(s).php_version=a),loading:z(l),options:z(n)},null,8,["value","loading","options"])]),N(i,{type:"primary",onClick:u},{default:q((()=>[A(I(a.$t("Public.Btn.Save")),1)])),_:1})])),_:1})])}}}),ma={class:"p-4px"},ca={class:"w-142px mr-8px"},va={class:"w-142px mr-8px"},_a={class:"w-240px"},ba={class:"w-240px"},ha={class:"w-240px"},xa=S({__name:"index",setup(a,{expose:t}){const{t:s}=U(),l=T(null),o=T(!1),d=T(null),m=T(!1);let c=!1;const v=M({username:"",password:"",repass:""}),_=async()=>{const a=l.value;null!==a?(await b({port:a}),H()):i.error(s("Database.phpadmin.index_25"))},j=async a=>{await h({v:a?1:0}),Z()},C=async()=>{const a=d.value;null!==a?(await x({port:a}),Z()):i.error(s("Database.phpadmin.index_26"))},P=a=>{!a&&c?n({title:s("Public.Confirm.Title"),content:s("Database.phpadmin.index_27"),onConfirm:async()=>{await y(),H()}}):m.value=a},S=async()=>{""!==v.password.trim()&&""!==v.username.trim()?v.password.length<3||v.username.length<3?i.error(s("Database.phpadmin.index_29")):v.password===v.repass?(await f({username:v.username,password:v.password}),H()):i.error(s("Database.phpadmin.index_30")):i.error(s("Database.phpadmin.index_28"))},F=T(!1),H=async()=>{try{F.value=!0;const{message:a}=await k({sName:"phpmyadmin"}),e=p(a,"ext.port",null);l.value=e?w(e):null,m.value=p(a,"ext.auth",!1),c=m.value}finally{F.value=!1}},W=T(!1),Z=async()=>{try{W.value=!0;const{message:a}=await g();o.value=p(a,"status",!1);const e=p(a,"port",null);d.value=e?w(e):null}finally{W.value=!1}},J=()=>{Promise.all([H(),Z()])};return J(),t({init:J}),(a,t)=>{const s=D,n=r,i=Q,p=u,c=Y,b=$,h=e,x=X;return B(),E("div",ma,[N(x,{"label-width":"160"},{default:q((()=>[N(i,{label:a.$t("Database.phpadmin.index_16")},{default:q((()=>[L("div",ca,[N(s,{value:z(l),"onUpdate:value":t[0]||(t[0]=a=>G(l)?l.value=a:null),min:0,max:66325,"show-button":!1,loading:z(F),placeholder:""},null,8,["value","loading"])]),N(n,{type:"primary",onClick:_},{default:q((()=>[A(I(a.$t("Public.Btn.Save")),1)])),_:1})])),_:1},8,["label"]),N(p,{dashed:""}),N(i,{class:"mt-20px",label:a.$t("Database.phpadmin.index_17")},{default:q((()=>[N(c,{value:z(o),loading:z(W),"onUpdate:value":j},null,8,["value","loading"])])),_:1},8,["label"]),N(i,{label:a.$t("Database.phpadmin.index_18")},{default:q((()=>[L("div",va,[N(s,{value:z(d),"onUpdate:value":t[1]||(t[1]=a=>G(d)?d.value=a:null),min:0,max:66325,"show-button":!1,loading:z(W),placeholder:""},null,8,["value","loading"])]),N(n,{type:"primary",onClick:C},{default:q((()=>[A(I(a.$t("Public.Btn.Save")),1)])),_:1})])),_:1},8,["label"]),N(p,{dashed:""}),N(i,{class:"mt-20px",label:a.$t("Database.phpadmin.index_19")},{default:q((()=>[N(c,{value:z(m),loading:z(F),"onUpdate:value":P},null,8,["value","loading"])])),_:1},8,["label"]),z(m)?(B(),E(R,{key:0},[N(i,{label:a.$t("Database.phpadmin.index_20")},{default:q((()=>[L("div",_a,[N(b,{value:z(v).username,"onUpdate:value":t[2]||(t[2]=a=>z(v).username=a),placeholder:a.$t("Database.phpadmin.index_23")},null,8,["value","placeholder"])])])),_:1},8,["label"]),N(i,{label:a.$t("Database.phpadmin.index_21")},{default:q((()=>[L("div",ba,[N(b,{value:z(v).password,"onUpdate:value":t[3]||(t[3]=a=>z(v).password=a),type:"password",placeholder:a.$t("Database.phpadmin.index_23")},null,8,["value","placeholder"])])])),_:1},8,["label"]),N(i,{label:a.$t("Database.phpadmin.index_22")},{default:q((()=>[L("div",ha,[N(b,{value:z(v).repass,"onUpdate:value":t[4]||(t[4]=a=>z(v).repass=a),type:"password",placeholder:a.$t("Database.phpadmin.index_23")},null,8,["value","placeholder"])])])),_:1},8,["label"]),N(i,{label:" "},{default:q((()=>[N(n,{type:"primary",onClick:S},{default:q((()=>[A(I(a.$t("Public.Btn.Save")),1)])),_:1})])),_:1})],64)):V("",!0),N(h,null,{default:q((()=>[L("li",null,I(a.$t("Database.phpadmin.index_24")),1)])),_:1})])),_:1})])}}}),ya={class:"h-580px"},fa=S({__name:"index",props:{row:{default:void 0}},setup(e){const t=W(e,"row"),{t:s}=U(),n=T("service"),l=[{key:"service",label:s("Database.phpadmin.index_1"),component:da},{key:"php",label:s("Database.phpadmin.index_2"),component:ra},{key:"safe",label:s("Database.phpadmin.index_3"),component:xa}];return C(aa,{mysqlInfo:t}),(e,t)=>{const s=a;return B(),E("div",ya,[N(s,{value:z(n),"onUpdate:value":t[0]||(t[0]=a=>G(n)?n.value=a:null),ref:"tabsRef",data:l},null,8,["value"])])}}});export{fa as default};
